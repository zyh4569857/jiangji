document.addEventListener('DOMContentLoaded', () => {
    // --- 全局状态和数据 ---
    let monthlyIncome = 0;
    let budgetSettings = { // 预算占比
        food: 0, clothing: 0, housing: 0, transport: 0,
        learning: 0, entertainment: 0, savings: 0
    };
    let actualBudgets = {}; // 各类别实际预算金额
    let expenses = []; // { date, category, amount, description }

    const CATEGORIES = {
        food: "食", clothing: "衣", housing: "住", transport: "行",
        learning: "学", entertainment: "娱", savings: "储蓄"
    };

    // --- DOM Elements (根据当前页面获取) ---
    // 首页元素
    const monthlyIncomeInput = document.getElementById('monthly-income');
    // const budgetPercentageInputs = document.querySelectorAll('.budget-percentage'); // Old
    const budgetPercentageSliders = document.querySelectorAll('.budget-percentage-slider'); // New
    // const totalPercentageSpan = document.getElementById('total-percentage'); // Old, replaced by total-percentage-value and progress bar
    const totalPercentageValueSpan = document.getElementById('total-percentage-value'); // New
    const totalPercentageBar = document.getElementById('total-percentage-bar'); // New
    const saveSetupButton = document.getElementById('save-setup');
    const quickSetupButton = document.getElementById('quick-setup');
    const budgetOverviewContainer = document.getElementById('budget-overview-container');

    // 记录页元素
    const expenseDateInput = document.getElementById('expense-date');
    const expenseCategorySelect = document.getElementById('expense-category');
    const expenseAmountInput = document.getElementById('expense-amount');
    const expenseDescriptionInput = document.getElementById('expense-description');
    const addExpenseButton = document.getElementById('add-expense');
    const budgetStatusContainer = document.getElementById('budget-status-container');

    // 总结页元素
    const summaryTotalIncomeSpan = document.getElementById('summary-total-income');
    const summaryTotalExpenseSpan = document.getElementById('summary-total-expense');
    const summaryTotalRemainingSpan = document.getElementById('summary-total-remaining');
    const categorySummaryContainer = document.getElementById('category-summary-container');
    const expenseChartCanvas = document.getElementById('expense-chart');
    const suggestionText = document.getElementById('suggestion-text'); // Existing suggestion text element

    // 新增：收入建议容器
    const incomeSuggestionsContainer = document.getElementById('income-level-suggestions-container');


    // --- 收入分级与消费建议数据 ---
    const incomeLevelsData = [
        {
            level: 1, minIncome: 1200,
            percentages: { clothing: 7, food: 50, housing: 25, transport: 8, learning: 3, entertainment: 2, savings: 5 },
            advice: {
                clothing: "理性消费，注重实用与耐穿。明确“必需”与“想要”，优先满足基本保暖与蔽体需求。选购衣物时，以基础款、深色系、百搭耐磨的棉质或混纺面料为主，避免追求潮流。积极关注二手市场、社区闲置群或亲友间的衣物赠与交换，能以极低成本获得合用衣物。学习基础的缝纫和修补技巧，如钉纽扣、缝合开线，能显著延长衣物使用寿命，减少不必要的换新开支。换季打折时可适当购入必需品，但切忌囤积。自己动手改造旧衣物，增加穿着乐趣。",
                food: "最大化利用预算，确保营养与健康。坚持每日三餐在家烹饪，严格控制外食及零食开销。采购食材时，多选择当季、本地产的平价蔬菜水果，如土豆、白菜、胡萝卜、苹果等。蛋白质来源可侧重鸡蛋、豆类制品（豆腐、豆浆）、少量鸡胸肉或鱼类（选择冰鲜或特价时购买）。学习制定一周简易菜单，提前规划，避免冲动购买和食材浪费。掌握“一菜多做”或利用边角料（如芹菜叶做汤）的技巧。多喝白开水，自制简易饮品（如柠檬水），替代高价瓶装饮料。",
                housing: "安全为首，尽力降低固定支出。若为学生，优先考虑校内宿舍，费用较低且相对安全。已工作者，首选与可靠的同学、同事或朋友合租床位或小单间，共同分摊房租及水电煤网等费用。选择住房时，可在城市非核心区域或交通相对便利的城中村寻找租金较低的房源。务必确保居住环境的基本安全（防火、防盗）与卫生。学习节约用水用电，如随手关灯、及时关闭水龙头，不仅环保，也能减少共同开支。签订租房合同前仔细阅读条款，明确责任。",
                transport: "经济高效，善用公共资源。日常出行首选步行或自行车，既锻炼身体又无需花费。距离稍远则依赖城市公共交通工具，如公交车、地铁，并积极办理和使用学生卡、月票、或各类城市交通优惠卡，最大限度利用折扣。提前规划出行路线，尽量选择换乘少、票价低的方案，避免高峰期出行以节省时间。若有共享单车，可作为短途接驳的经济选择。尽量减少不必要的出行，若需外出办事，尝试将多个目的地合并在一次行程中完成，提高效率。 ",
                learning: "广泛利用免费资源，持续自我提升。充分利用城市公共图书馆资源，免费借阅书籍、期刊，使用自习室和电子阅览设备。积极搜寻并参与各类免费的线上公开课（MOOC）、公益讲座、技能培训项目，如“国家数字图书馆”、“学堂在线”等平台均有丰富资源。购买教材时，优先考虑二手书或电子版，价格更低廉。与同学朋友建立学习小组，共享学习资料，互相督促。关注政府或社区提供的免费技能培训信息，提升实用技能为未来发展打基础。 ",
                entertainment: "发掘免费乐趣，保持积极心态。积极参与社区或学校组织的免费文体活动，如露天电影放映、广场舞、体育比赛等。利用城市公园、草地等公共空间进行体育锻炼，如跑步、散步、做操。阅读是从图书馆借阅的书籍，或在线阅读公共领域的经典作品，是成本极低的优质娱乐。与朋友进行低成本的社交活动，如在家一起做饭、玩棋牌桌游、交流心得。关注博物馆、美术馆的免费开放日或学生优惠时段，接触文化艺术。",
                savings: "培养储蓄意识，积少成多应对不时之需。尝试从每月固定划拨一小笔金额（例如30-50元）开始储蓄，关键在于养成习惯而非数额多少。可以使用一个独立的储蓄罐或开立一个几乎不动的银行活期账户专门用于储蓄。认真记录每笔开销，月底复盘，看是否有可压缩的非必要支出转为储蓄。即使储蓄金额小，也能在心理上建立安全感，并为应对小额突发状况（如生病买药）提供缓冲。避免任何形式的借贷消费，尤其是高利息网贷。"
            }
        },
        {
            level: 2, minIncome: 1800,
            percentages: { clothing: 7, food: 45, housing: 25, transport: 8, learning: 4, entertainment: 3, savings: 8 },
            advice: {
                clothing: "兼顾实用与适度体面，提升搭配能力。在满足基本需求基础上，可于换季打折或大型促销活动（如双十一）时，购入1-2件品质稍好、款式经典、穿着场合较多的单品，如合身的衬衫、不易过时的牛仔裤。继续关注二手平台或衣物交换活动。学习基础的色彩搭配和穿搭技巧，利用现有衣物组合出不同风格，让简单衣物也能穿出整洁感和活力。注重衣物的清洁和保养，如正确洗涤、及时修补，保持衣物良好状态，避免频繁购买。",
                food: "优化饮食结构，提升生活品质。继续以在家烹饪为主，确保食材的新鲜和卫生。可适当增加优质蛋白质的摄入比例，如每周安排2-3次鱼类、禽肉，每日保证蛋奶和豆制品的供应。学习更多简单易学且营养均衡的家常菜谱，尝试用不同烹饪方法（如蒸、煮、烤）处理食材，减少油炸。有计划地进行食材采购，避免浪费，可以周末集中采购一周所需耐储食材。工作日午餐尽量自己带饭，若条件不允许，则选择卫生、经济的快餐或食堂。",
                housing: "寻求稳定与性价比，改善居住条件。与熟悉且生活习惯相近的人合租，选择管理相对规范的小区，共同分摊租金、水电、网络等费用，能有效控制居住成本。积极留意政府针对青年人或低收入群体推出的公共租赁住房、人才公寓等政策性住房信息，符合条件应尽早申请。选择合租房时，既要考虑租金，也要综合考量通勤时间与费用、周边生活配套设施的便利性。与室友共同制定并遵守合住公约，保持公共区域的整洁，营造和谐居住环境。",
                transport: "规划高效出行，结合多种方式。日常出行仍以公共交通为主要选择，熟悉所在城市的公交、地铁线路及运营时间，合理规划行程。若工作或学习地点固定且距离适中（5-10公里内），购买一辆质量可靠的二手自行车或保养良好的新自行车，是非常经济环保的选择，同时也能锻炼身体。对于偶尔的长距离或夜间出行，可适度使用网约车的经济型服务，但需控制频率。参与同事或朋友间的顺路拼车，分摊油费，也是降低成本的有效方式。 ",
                learning: "投资实用技能，拓展知识面。预算允许的情况下，可以购买一些职业发展或个人提升相关的经典书籍或付费课程（选择性价比高的）。重点关注那些能直接提升工作技能、有助于拓宽就业渠道或增加收入潜力的领域，如基础的办公软件操作、入门级的外语沟通、新媒体运营知识等。继续利用好各类免费学习资源，如图书馆、在线教育平台的公益课程、行业论坛的免费分享等。制定明确的学习目标和计划，保证学习效果。",
                entertainment: "丰富精神生活，保持社交活力。积极参与社区、单位或学校组织的各类文化体育活动，如读书会、观影团、运动小组等，这些活动通常免费或费用很低。与朋友进行低成本的聚会，如组织家庭KTV、户外野餐、主题电影夜、共同参与志愿服务等。利用周末或节假日，到城市周边的公园、郊野公园进行短途徒步或骑行。关注本地文化场馆（博物馆、美术馆、科技馆）的优惠信息，选择在免费日或购买优惠票参观，陶冶情操。",
                savings: "稳步增加储蓄，建立应急保障。努力将每月收入的至少8%固定存下来，目标是逐步建立起相当于1-2个月生活费的应急备用金，以应对失业、疾病等突发情况。可以考虑开通工资卡自动转存功能，每月发薪日后自动将固定金额转入储蓄账户，强制储蓄。学习一些基础的理财知识，了解货币基金等低风险、流动性较好的现金管理工具，让小额储蓄也能产生微薄收益。避免不必要的消费，如戒掉烟酒、减少冲动购物，将省下的钱投入储蓄。"
            }
        },
        {
            level: 3, minIncome: 2500,
            percentages: { clothing: 7, food: 40, housing: 25, transport: 8, learning: 5, entertainment: 5, savings: 10 },
            advice: {
                clothing: "注重性价比与搭配，打造实用衣橱。选购衣物时，多关注快时尚品牌的基础款和打折促销品，如纯色T恤、经典款式的牛仔裤、简约外套等，这些单品实用性强且易于搭配。学习并实践“一衣多搭”的技巧，通过不同的组合和配饰（如平价的围巾、帽子）让有限的衣物穿出多样风格，提高衣物利用率。购物前列好清单，避免冲动消费。可以关注一些分享平价穿搭的博主，获取灵感。适当添置少量运动或休闲服装，满足日常生活多场景需求。",
                food: "合理控制外食，提升烹饪乐趣。在家做饭仍是主要选择，以保证健康和控制开销。每周可允许自己有1-2次经济型外卖或简餐，作为调剂，但要注意选择卫生、少油盐的商家。积极学习并尝试制作几道自己喜欢且操作简单的拿手菜，周末时间充裕时可以精心准备一两顿改善伙食，既满足味蕾，也增加生活情趣。采购食材时可以对比周边几家菜市场或超市的价格，选择性价比高的。学会储存食材，如蔬菜分类保鲜，肉类分装冷冻，减少浪费。",
                housing: "权衡通勤与租金，确保居住安全。在大城市，此预算下合租是常态。在确保居住安全和基本卫生条件的前提下，可以考虑选择距离市中心或工作地点稍远，但公共交通仍便利且租金相对较低的区域。仔细权衡通勤时间、交通费用与房租之间的平衡。合租时，与室友明确水电煤网等费用的分摊方式，并共同维护公共区域的整洁。签订租房合同前，务必仔细阅读条款，警惕“租金贷”等陷阱，尽量选择正规中介或房东直租。",
                transport: "深度利用公共交通，尝试错峰出行。日常出行完全依赖公共交通网络，如公交、地铁。熟悉并规划好常用通勤及外出路线，了解早晚高峰期拥堵路段，尽可能错峰出行，不仅能节省在途时间，有时也能避开高峰期较高的票价（部分城市有分时计价）。下载并使用智能公交APP，实时查询车辆到站信息，减少等待时间。若偶尔需要携带较多物品或天气不佳，可选择出租车或网约车的起步价范围内的短途服务，但需严格控制次数。",
                learning: "针对性投入，提升职业竞争力。可根据自身职业发展方向，购买1-2本高质量的行业相关书籍进行深度阅读，或订阅有价值的付费专栏、电子期刊，获取前沿资讯和深度分析。关注并筛选性价比高的单科线技能提升课程，如Excel高级应用、PPT制作、基础编程入门等，选择那些能直接应用于工作、提升效率或有助拓展职业路径的实用技能。利用周末时间参与一些免费或低成本的线上研讨会、行业交流活动，扩大人脉圈。",
                entertainment: "适度安排文娱活动，培养低成本爱好。每月可规划1-2次平价的文化娱乐活动，如观看早场或优惠时段的电影，参观小型免费或低票价的艺术展览、博物馆。培养一项或多项可持续且成本较低的个人爱好，如跑步（只需跑鞋）、在家跟着视频做瑜伽、阅读（利用图书馆）、用手机学习基础摄影、练习书法或绘画（入门级材料不贵）。与朋友的社交可以多采取AA制聚餐或参与彼此的家庭聚会，减少不必要的娱乐开销。",
                savings: "启动应急储蓄，学习基础理财。开始正式建立并逐步积累个人应急备用金，目标是能够覆盖3个月的生活费（如房租、伙食、交通）。这意味着每月需固定存下此部分预算。可以将资金存入银行的零存整取或通知存款中，也可以开始尝试使用余额宝、零钱通等货币基金产品进行现金管理，这类产品通常风险较低，流动性较好，且能获得略高于活期存款的收益。坚持记账，了解自己的消费习惯，找出可优化的支出点，增加储蓄额度。"
            }
        },
        {
            level: 4, minIncome: 3500,
            percentages: { clothing: 8, food: 35, housing: 25, transport: 9, learning: 6, entertainment: 7, savings: 10 },
            advice: {
                clothing: "*适度提升品质，兼顾通勤与休闲。可在预算内购入少量品质稍好、更耐穿的通勤装，如面料挺括的衬衫、不易起球的针织衫、版型较好的裤装。关注常购品牌的会员活动、特卖会或奥特莱斯折扣信息，能以较低价格买到性价比较高的单品。学习分辨不同面料的优劣和保养方法，延长衣物寿命。除了通勤装，也可以配置1-2套适合周末休闲或轻度运动的服装。思考“每件衣物的穿着成本”（价格/预计穿着次数），理性购买。",
                food: "追求饮食均衡，享受健康烹饪。在家做饭与适度外食相结合。工作日午餐若公司有食堂，是不错的选择；若无，则鼓励自己提前一晚准备便当，或选择有资质、口碑好的餐饮商家提供的健康简餐。周末可以花些时间研究健康食谱，尝试自己制作一些营养均衡、美味可口的菜肴，如杂蔬沙拉、烤鸡胸肉、全麦三明治等。采购时可适当增加鱼虾、瘦肉、时令水果的比例。减少购买高糖分、高脂肪的加工食品和零食，培养健康饮食习惯。",
                housing: "提升居住私密性，营造舒适小窝。若合租条件允许，且个人对私密性有较高要求，可以考虑在合租房中选择带有独立卫生间的单间，或面积稍大、朝向更好的房间，以提升居住舒适度。在预算内，可以通过添置一些软装饰（如绿植、地毯、装饰画、舒适的床上用品）来改善居住环境，打造温馨的个人空间。继续关注本地公租房、保障性租赁住房的申请政策，若符合条件，积极享受，能显著降低居住成本。",
                transport: "公共交通优先，考虑经济型辅助。日常通勤仍以公共交通为主要方式，确保经济高效。若工作地点偏远，公共交通耗时过长且极不便利，可与few住址相近、目的地相同的同事或朋友建立稳定的合伙拼车，共同分摊油费和车辆损耗，但需提前约定好规则和费用。若考虑购买代步工具，此收入水平下可优先考虑二手电动车或经济型摩托车（需符合当地政策），并充分核算后续的充电/加油、维修、保险等费用。 ",
                learning: "规划短期培训，储备育儿知识。每年可以规划参加1-2个与职业技能紧密相关的短期培训班或线上认证课程，例如项目管理入门、数据分析基础、特定软件的系统学习等，以增强自身在职场上的不可替代性。若有生育计划或已有子女，可以开始系统地阅读育儿书籍、参加线上父母课堂、关注母婴健康类讲座，为子女的早期教育与acee成长做好知识和脑筋上的准备。持续关注行业动态，保持学习热情。",
                entertainment: "增加社交与体验，规划短途旅行。适当增加与朋友、同事的社交活动，如每月1-2次AA制聚餐、参与团队建设活动、共同观看体育比赛或文艺演出（可选择二线或社区级演出，票价更亲民）。每年可规划1-2次短途周边游，如利用周末或小长假到邻近城市或风景区放松身心。提前规划行程、预订车票住宿通常能获得更优惠的价格。培养一项能带来持续乐趣且有一定社交属性的爱好，如加入羽毛球club、徒步社群等。",
                savings: "积极积累资金，了解稳健理财。将每月固定储蓄的比例提升至10%或以上，主要目标是尽快完成3-6个月生活费的应急备用金积累。在应急金逐步到位的同时，可以开始系统学习和了解风险较低的稳健型理财产品，如银行定期存款（不同期限利率有差异）、大额存单（门槛较高但利率可能更优）、记账式国债等。这些产品本金相对安全，收益稳定，适合作为初期理财的入门选择。坚持“先储蓄后消费”的原则，严格执行预算。"
            }
        },
        {
            level: 5, minIncome: 5000,
            percentages: { clothing: 8, food: 30, housing: 25, transport: 10, learning: 8, entertainment: 9, savings: 10 },
            advice: {
                clothing: "构建核心衣橱，注重品质与搭配。开始系统建立包含四季穿着的核心衣橱，纳入多件经典款式，如优质白衬衫、合身西裤/半裙、羊毛衫、一件百搭外套等。购物时，学习辨别衣物的主要材质（如棉、麻、羊毛、聚酯纤维等）及其特性，优先选择天然、耐穿、易于打理的面料。对于鞋包等使用频率高的配饰，可适当投入预算购买品质较好的款式，提升整体形象且更耐用。学习基本的量体和服装修改知识，确保衣物合身，或在必要时寻求平价裁缝帮助。",
                food: "追求均衡营养，享受健康生活。更加注重饮食的均衡与健康，主动减少高油、高盐、高糖的外卖和加工食品摄入。工作日尽量自己备餐或选择提供健康餐食的商家。每周可安排1-2次与家人或朋友外出就餐，选择环境舒适、食材新鲜、性价比高的餐厅，可以是地方特色菜馆或有良好口碑的家常菜馆。周末可以尝试制作一些略微复杂的菜肴或烘焙，提升烹饪技能和生活乐趣。逛菜市场或超市时，有意识地选择多种颜色的蔬果，保证维生素和膳食纤维的摄入。",
                housing: "提升居住独立性或合租品质。此收入水平下，若在一二线城市，可考虑在交通相对便利、生活配套设施完善的区域，独立租赁一居室或开间，享受更独立的居住空间。若仍选择合租，则可以寻求房间数量更少（如两室或三室）、公共区域更大、装修和家电配置更好、物业管理更规范的品质公寓。签订租赁合同时，仔细确认房屋状况、维修责任、费用明细等条款。适当添置小型家电或家居用品，提升居住的便利性和舒适感。",
                transport: "考虑家庭用车需求，鼓励绿色智能。若家庭成员较多或出行需求复杂（如兼顾通勤、接送孩子、周末出游），且经济条件允许，可以考虑购买或置换第二辆家庭用车，例如一辆更适合家用的MPV或空间较大的SUV。在选择车辆时，除了品牌、性能、安全性外，也应积极响应绿色出行理念，优先考虑购买新能源汽车（纯电动或插电式混合动力），享受可能的政策补贴和牌照便利，并为环保贡献力量。合理规划车辆使用，避免不必要的闲置和浪费。",
                learning: "规划长远发展，考虑在职深造。为自己和家庭成员（尤其是配偶）规划更长期的学习和职业发展路径。例如，可以考虑攻读在职MBA、EMBA或与职业高度相关的硕士/博士学位，以提升管理能力和战略思维。积极寻找并争取参加国际性的行业会议、短期海外交流项目或访问学者机会，拓宽国际视野，积累跨文化经验。在子女教育方面，已保证优质的基础教育外，可开始为其规划更长远的教育路径，如了解国际课程体系、海外留学的可能性及准备工作。",
                entertainment: "体验定制旅行，参与文化文娱。提升旅行的品质感个性化体验，可以考虑选择一些提供半定制或全定制服务的中高端旅行社，规划符合个人兴趣和需求的深度游、主题游（如历史文化探索、美食美酒之旅、户外探险等）。积极参与更高品质的文化艺术活动，如定期观看国家级院团的歌剧、芭蕾舞、交响音乐会，或购买艺术展览的会员，深入了解艺术领域。也可以开始培养一些需要持续投入和学习的爱好，如学习一foreign语言并计划到母语国家旅行。",
                savings: "明确储蓄目标，尝试基金定投。应急备用金（3-6个月生活费）应基本建立或加速完成。接下来，要设定更明确的储蓄目标，如购房首付款的一部分、购买大件耐用品（如家电、电脑）、未来教育储备金等。开始学习并尝试进行指数基金的定期定额投资，选择沪深300、中证500等代表性宽基指数基金，通过每月固定投入（如300-500元）的方式，利用长期复利效应积累财富。务必理解基金投资有风险，需用闲钱投资并做好长期持有的准备。"
            }
        },
        {
            level: 6, minIncome: 7000,
            percentages: { clothing: 8, food: 28, housing: 24, transport: 10, learning: 10, entertainment: 10, savings: 10 },
            advice: {
                clothing: "提升着装品味，注重细节与场合。在核心衣橱基础上，可添置少量具有设计感或适合特定社交、工作场合（如重要会议、年会）穿着的衣物。更加注重服装的剪裁、版型和细节处理。学习运用高品质的配饰，如一条质感好的真皮皮带、一块经典款手表、几条不同风格的围巾或领带，来提升整体着装的品味和精致感。在能力范围内，选择一些信誉良好、有一定口碑的品牌，其产品在质量和设计上通常更有保障。开始关注服装保养，如西装干洗、羊毛制品手洗等。",
                food: "精选新鲜食材，享受烹饪乐趣。更加注重食材的新鲜度、来源和品质，例如选择当日捕捞的海鲜（若居住在沿海城市）、有机认证的蔬菜水果、散养土鸡蛋等。可以尝试学习制作一些地方特色菜肴、异国风味料理或进行家庭烘焙，将烹饪作为一种创作和享受生活的方式。若时间允许，周末邀请朋友或家人来家中聚餐，共同制作和分享美食，既温馨又比在外就餐经济实惠。了解不同季节的时令食材，顺应自然规律饮食，既美味又营养。",
                housing: "权衡购房与租房，优化居住体验。此收入水平是许多人开始认真考虑首次购房的起点。若有购房计划，需仔细评估自身经济状况、首付能力及未来月供压力，可考虑在城市近郊购买总价相对较低、交通尚可的小户型新房或二手房。若暂无购房打算或希望居住在市中心，则可以选择租住装修更好、物业管理更完善、社区环境更成熟的公寓。无论租房还是购房，都要将居住安全、通勤便利性、周边生活配套作为重要考量因素。",
                transport: "理性规划购车，日常绿色出行。若确有购车必要（如家庭出行需求、工作性质特殊），需将购车预算及后续的油费/电费、保险费、保养维修费、停车费、过路过桥费、交通罚款等各项养车成本进行全面、细致的测算和长期规划。优先选择燃油经济性高、保值率较好的、维修保养成本相对较低的车型。即便购车，日常通勤仍建议优先结合公共交通、自行车或步行，以降低开销、减少拥堵并践行绿色出行理念，车辆更多用于周末、节假日或特殊情况。",
                learning: "参与专业交流，规划系统学习。主动寻找并参加与本行业相关的研讨会、专业论坛、线上讲座等，了解行业最新动态、拓宽专业人脉、提升认知水平。为自己或家人（如配偶共同进步、子女教育规划）制定更为系统的学习计划，例如备考一项有含金量的职业资格证书、系统学习一foreign语言以达到流利沟通水平、报名参加能提升核心竞争力的专项技能课程。开始关注理财知识的系统学习，而不仅仅是了解产品。",
                entertainment: "*体验品质娱乐，拓展旅行视野。消费能力提升，可以享受更高品质的文化娱乐活动，如观看口碑好的话剧、音乐会、现场体育赛事（选择合适的场次和座位），或参观大型艺术展览。每年可规划1-2次国内深度游，选择有历史文化底蕴或自然风光独特的目的地；或者可以开始尝试规划一次预算可控的短途出境游（如东南亚、日韩等签证便利、消费水平相对适中的国家或地区），体验不同文化，拓宽国际视野。",
                savings: "加大储蓄投资，尝试多元配置。在确保应急备用金充足（建议提升至6-9个月生活费）的前提下，应有意识地增加每月储蓄和投资的金额与比例。除了坚持指数基金定投外，可以开始了解并小额尝试配置更多元化的理财产品，如风险等级适中的混合型基金（股债平衡）、银行发行的结构性理财产品（需仔细阅读产品说明书，了解其风险收益特征）。开始建立清晰的长期财务目标（如5-10年内的购房、子女教育、养老储备等），并据此调整投资策略。"
            }
        },
        {
            level: 7, minIncome: 8000,
            percentages: { clothing: 8, food: 25, housing: 25, transport: 10, learning: 10, entertainment: 10, savings: 12 },
            advice: {
                clothing: "打造个人风格，适度购买设计师品牌或轻奢品。开始形成自己独特的穿衣风格，不再盲目追求潮流。可以关注并适度投资一些国内外设计师品牌、有品质的轻奢品牌或具有收藏价值的经典款单品。学习服装材质、剪裁和品牌文化，提升审美素养。考虑定制服务，如定制衬衫、西装，以获得更佳的合身度和品质感。将衣物保养视为重要环节，使用专业的洗护产品和服务。",
                food: "享受美食体验，关注食材品质与来源。在保证日常饮食健康均衡的基础上，可以适当增加外出就餐的频率，探索有特色、口碑好的餐厅，享受不同菜系的美食体验。关注食材的品质、产地和有机认证，可以选择购买有机蔬菜、散养禽畜肉、进口优质海鲜等。学习一些高级烹饪技巧或参加烹饪课程，提升厨艺，为家人朋友制作更精致的菜肴。可以考虑在家添置一些提升烹饪体验的厨具，如咖啡机、破壁机、烤箱等。",
                housing: "改善居住品质，考虑购买或置换房产。若尚未购房，此阶段可积极规划购房事宜，根据家庭需求和经济实力，选择地段、户型、学区（若有需求）均合适的房产。若已有房产，可考虑进行改善型置换，如换购面积更大、位置更好、配套更完善的住房。注重家居环境的舒适度和个性化，可以聘请室内设计师进行装修设计，或购买高品质的家具、家电，提升生活品质。关注社区环境和物业服务质量。",
                transport: "优化出行方式，兼顾效率与舒适。根据家庭实际需求和经济状况，可以考虑购买或升级家庭用车，选择品牌、性能、安全性更优的车型。若日常通勤距离较远或对出行效率有较高要求，可考虑购买月票或年票乘坐更舒适快捷的公共交通工具（如高铁、城际列车的部分线路）。在长途旅行时，可以选择飞机商务舱或高铁一等座，提升旅途舒适度。合理规划车辆保养和保险，确保出行安全。",
                learning: "持续专业深造，拓展国际视野。积极寻求并参与行业内的高端培训、研讨会、峰会，与同行精英交流学习，拓展人脉资源。可以考虑攻读与职业发展相关的在职硕士、博士学位，或参加有国际认证的专业资格考试。若语言能力允许，多阅读外文专业文献和书籍，关注国际前沿动态。为子女提供更优质的教育资源，如选择教学质量高的私立学校、国际学校，或为其规划海外留学（如夏令营、交换生项目）。",
                entertainment: "追求品质体验，培养高雅爱好。提升文化娱乐消费的品质，如定期观看热门话剧、音乐剧、演唱会，参观国内外知名艺术展览。可以培养一些需要持续投入和更高技巧的爱好，如乐器演奏（钢琴、小提琴）、马术、高尔夫、潜水等。规划更有深度的国内外旅行，如文化遗产探访、自然风光摄影、美食主题之旅等。可以考虑加入一些高端俱乐部或社群，拓展社交圈，享受会员专属服务。",
                savings: "多元化资产配置，关注财富传承。在稳健理财的基础上，进一步学习和实践多元化的资产配置策略。可以考虑增加权益类资产（如股票、指数基金）的投资比例，适当配置另类投资（如私募股权、信托产品，需谨慎评估风险）。开始关注财富传承问题，了解遗嘱、保险、家族信托等工具的运用。为家庭配置充足的商业保险，包括寿险、重疾险、意外险、高端医疗险、意外险等，确保家庭财务安全网的稳固。"
            }
        },
        {
            level: 8, minIncome: 12000,
            percentages: { clothing: 7, food: 22, housing: 22, transport: 11, learning: 13, entertainment: 11, savings: 14 },
            advice: {
                clothing: "精简衣橱，投资经典高品质单品。践行“少而精”的购衣理念，定期整理衣橱，及时处理（通过二手平台出售、捐赠或环保回收）不再穿着或不合身的衣物。将预算更多地投入到购买经久耐穿、设计经典、面料上乘的高品质服装上，如一件做工精良的羊绒大衣、一套合体的品牌西装、几双舒适耐穿的真皮鞋履。这些单品虽然初次投入较高，但长期来看因其耐用性和百搭性反而更经济。关注一些有良好口碑的国内外设计师集成店或买手店。",
                food: "注重膳食管理，关注健康与效率。全面关注家庭成员的健康膳食管理，可以定期安排家庭体检，并根据体检结果和医生建议调整饮食结构。若对营养搭配有更高要求，可以考虑短期咨询专业营养师，获取个性化的膳食指导方案。在时间精力有限情况下，为保证饮食质量和节省烹饪时间，有条件的家庭可以考虑聘请钟点工协助处理部分家务（如买菜、食材初加工、厨房清洁），或选择信誉良好的半成品净菜配送服务、健康餐定制服务。",
                housing: "优选地段房产，考虑服务式公寓。若计划购房，可重点考虑城市核心区域或交通枢纽附近，地段优越、生活配套成熟、教育医疗资源相对集中的商品房。购买时需仔细评估房产的增值潜力、社区品质及物业服务水平，确保月供在家庭可承受范围之内（一般不超过家庭月收入的30%-40%）。对于工作繁忙、追求高品质生活便利性的单身人士或年轻家庭，也可以考虑租住或购买装修现代、配套齐全、提供酒店式管理的“服务式公寓”。",
                transport: "考虑家庭用车需求，鼓励绿色智能。若家庭成员较多或出行需求复杂（如兼顾通勤、接送孩子、周末出游），且经济条件允许，可以考虑购买或置换第二辆家庭用车，例如一辆更适合家用的MPV或空间较大的SUV。在选择车辆时，除了品牌、性能、安全性外，也应积极响应绿色出行理念，优先考虑购买新能源汽车（纯电动或插电式混合动力），享受可能的政策补贴和牌照便利，并为环保贡献力量。合理规划车辆使用，避免不必要的闲置和浪费。",
                learning: "规划长远发展，考虑在职深造。为自己和家庭成员（尤其是配偶）规划更长期的学习和职业发展路径。例如，可以考虑攻读在职MBA、EMBA或与职业高度相关的硕士/博士学位，以提升管理能力和战略思维。积极寻找并争取参加国际性的行业会议、短期海外交流项目或访问学者机会，拓宽国际视野，积累跨文化经验。在子女教育方面，已保证优质的基础教育外，可开始为其规划更长远的教育路径，如了解国际课程体系、海外留学的可能性及准备工作。",
                entertainment: "体验定制旅行，参与品质文娱。提升旅行的品质感个性化体验，可以考虑选择一些提供半定制或全定制服务的中高端旅行社，规划符合个人兴趣和需求的深度游、主题游（如历史文化探索、美食美酒之旅、户外探险等）。积极参与更高品质的文化艺术活动，如定期观看国家级院团的歌剧、芭蕾舞、交响音乐会，或购买艺术展览的会员，深入了解艺术领域。也可以开始培养一些需要持续投入和学习的爱好，如学习一foreign语言并计划到母语国家旅行。",
                savings: "构建稳健组合，配置保障型保险。投资目标应更为长远和多元。在坚持基金定投的基础上，可以逐步增加对优质蓝筹股、成长股的直接投资（需具备一定的研究分析能力和风险承受能力），或选择投资门槛稍高、风险相对可控的优质债券型基金、银行理财子公司发行的净值型理财产品。此阶段务必重视家庭风险保障，为家庭主要收入来源者配置充足的商业保险、定期寿险和高保额重大疾病保险，为子女购买教育金保险或医疗保险，确保家庭财务安全。"
            }
        },
        {
            level: 9, minIncome: 15000,
            percentages: { clothing: 7, food: 20, housing: 22, transport: 11, learning: 14, entertainment: 11, savings: 15 },
            advice: {
                clothing: "打造品质衣橱，兼顾商务与休闲。注重购买剪裁精良、面料上乘（如纯羊毛、真丝、高支棉）的商务正装和舒适有型的休闲装。可以选择国内外知名度较高、设计和品质有保障的中高端品牌。开始形成相对固定的个人穿衣风格，并根据不同场合（如商务会议、社交晚宴、家庭聚会、户外休闲）配置相应的服饰。对于重要单品，如西装、大衣，可考虑半定制或寻找工艺精湛的成衣品牌，确保合身与舒适。学习专业的衣物护理知识，延长高品质衣物寿命。",
                food: "严选食材供应商，尝试健康定制。对日常饮食的营养均衡与食品安全提出更高要求。选择可信赖的生鲜电商平台、高端超市的有机食品专区或有良好口碑的本地农场直供作为主要食材来源。若时间和精力允许，可尝试聘请短期或按次的私厨上门服务，为家庭聚会或特殊纪念日打造专属菜单。也可以考虑预定专业机构提供的个性化健康餐定制与配送服务，确保工作繁忙时也能获得均衡营养。开始了解并实践一些食疗养生知识。",
                housing: "锁定优质地段，考虑改善型置业。若有购房或换房需求，此阶段应重点关注城市核心或副中心区域，具有良好学区资源、成熟医疗配套、便捷交通网络及浓厚人文气息的优质地段房产。面积方面可考虑满足家庭长期居住需求的三居室或更大户型。若对现有住房不完全满意，可规划进行一次全面的改善型装修，聘请专业设计师，选用环保优质的建材和家电，提升居住空间的舒适度、功能性和美观度，打造理想家园。",
                transport: "选择适全家车型，注重安全保养。根据家庭成员数量、出行习惯及实际需求（如是否经常长途自驾、有无二胎计划等），选择空间宽敞、安全性能高、品牌口碑好的家用车型，如中型SUV、MPV或B级轿车。购车时除了车辆本身，还需关注其智能化配置、主被动安全系统。务必定期到授权4S店或专业维修机构对车辆进行全面保养和检查，及时更换易损件，确保行车安全。可以为车辆购买较全面的商业保险，增加保障。",
                learning: "聚焦国际化教育，参与高端研修。重点关注子女的教育投入，为其规划国际化的教育路径，例如选择 readout local teaching quality high international school or dual language school (need comprehensive investigation of course structure, teacher strength and admission rate), or for future study abroad, prepare for language training, background improvement project.",
                entertainment: "体验会员制服务，规划主题旅行。享受更高层次的休闲娱乐体验。可以办理本地知名高端健身房、运动俱乐部（如网球、游泳）或特定兴趣社群的会员卡，享受更专业的设施、指导和服务。每年规划1-2次家庭年度主题旅行，例如前往国内外著名的人类古迹进行文化深度游，或到自然保护区进行生态探险之旅，或选择高品质的邮轮旅行。旅行前精心策划行程，预订优质酒店和特色体验项目，提升旅行的舒适度和满意度。",
                savings: "加大长期投资，初步规划传承。在确保家庭应急金和保险保障充足的基础上，应显著加大长期投资的比例和金额。重点配置权益类资产（如绩优股、成长型基金）、固定收益类资产（如高信用等级债券、信托产品），并根据市场情况和自身风险承受能力动态调整。开始初步学习和了解财富传承的相关知识，例如遗嘱的重要性、保险在财富传承中的作用、家庭信托的基本概念等，为未来数十年的财富规划和顺利交接做早期准备。"
            }
        },
        {
            level: 10, minIncome: 18000,
            percentages: { clothing: 7, food: 18, housing: 21, transport: 11, learning: 15, entertainment: 12, savings: 16 },
            advice: {
                clothing: "塑造鲜明风格，投资经典奢侈品。积极关注国内外优秀独立设计师品牌以及国际一线奢侈品牌的最新动态，从中挑选符合个人气质和审美品味的单品，逐步构建具有鲜明个人风格且不易过时的衣橱体系。可适当投资购买1-2件具有标志性设计和卓越工艺的奢侈品牌经典款配饰，如高端腕表、经典款手袋、品质上乘的丝巾或领带，这些单品不仅能提升整体造型质感，部分款式还具有一定的保值潜力。开始了解高级定制服装的流程和价值。",
                food: "尊享品质餐饮，融入食疗养生。更高频率地享受高品质的餐饮体验，例如每月安排1-2次品尝本地所述的米其林星级餐厅、黑珍珠餐厅或有独特料理理念的高级食府。nexploits和尝试不同国家和地区的美食文化。同时，更加系统地关注和实践中医食疗养生或现代营养学的健康理念，根据个人体质和季节变化调整膳食结构，选用道地药材或功能性食材进行日常调理。有条件亦可聘请营养顾问或参与高端健康管理项目。",
                housing: "配置核心房产，考虑多元持有。重点考虑在经济发达、人口持续流入的核心一二线城市，购买具有长期持有价值和较强升值潜力的优质房产，例如市中心稀缺地段的公寓、知名学区房或景观资源独特的住宅。在资金允许的情况下，可以开始考虑房产的多元化配置，例如在国内热门旅游城市或风景区购买一套度假房产，用于家庭休闲度假或短期出租以获取额外收益。对于持有的房产，应关注其物业管理和维护。",
                transport: "升级座驾品牌，尊享出行服务。选购汽车时，可以考虑更注重舒适性、安全性、科技感和品牌价值的中高端乃至豪华汽车品牌，如BBA（奔驰、宝马、奥迪）的入门或中级车型，或其他同级别品牌。若工作繁忙、应酬较多或注重出行效率与私密性，可以考虑聘请经验丰富的兼职或全职司机，或长期固定使用高端网约车平台的尊享型服务（如礼宾车、商务车接送）。长途旅行时，优先选择飞机公务舱或高铁一等座/商务座。",
                learning: "规划精英教育，参与深度研究。为子女规划顶尖的教育资源，包括但不限于国内顶尖的公立/私立学校的优质班型，或积极准备并申请海外知名中小学乃至世界一流大学。此阶段的教育投入不仅是学费，也包括高质量的课外辅导、国际竞赛参与、海外夏令营等背景提升项目。个人层面，若有学术或专业兴趣，可利用业余时间参与所在专业领域的深度研究项目，与高校或研究机构合作，甚至尝试发表学术论文或撰写专业书籍、行业报告。",
                entertainment: "参与高端运动，定制深度旅行。将休闲娱乐提升至更高层次，可以开始学习并参与一些具有一定门槛和社交属性的高端运动，如高尔夫、马术、帆船、潜水等，这些运动不仅锻炼身体，也是拓展高端社交圈的有效途径。旅行方面，更倾向于进行有文化内涵、体验独特的深度定制旅行，例如聘请私人向导探索小众目的地、参与特定主题（如艺术、历史、摄影、美食）的海外研学团，或进行有一定挑战性的探险旅行。",
                savings: "资产全球配置，强化家庭保障。资产配置的视野应更加开阔和多元化。在专业人士（如私人银行客户经理、独立理财规划师）的建议下，可以逐步考虑将一部分资产配置于海外市场（如投资于全球主要股市的QDII基金、美股、港股，或在风险可控前提下考虑海外房产）。同时，可以接触和了解一些另类投资品种，如小额参与艺术品投资基金、高端红酒收藏等（需极强的专业知识和风险辨别能力）。务必为家庭配置全面且充足的保险保障，包括高额寿险、重疾险、意外险、高端医疗险以及家庭财产险等。"
            }
        },
        {
            level: 11, minIncome: 22000,
            percentages: { clothing: 7, food: 17, housing: 20, transport: 11, learning: 16, entertainment: 12, savings: 17 },
            advice: {
                clothing: "打造专业形象，寻求顾问指导。衣橱构建应完全符合个人职业身份、社交场景和生活品味的高标准。投资于国内外一线品牌或高级定制（Bespoke）的西装、衬衫、礼服等核心单品，确保面料顶级、剪裁完美。可以考虑聘请专业的形象顾问或私人造型师，进行从发型、妆容（若需）到服饰搭配、礼仪的全方位形象规划与管理。注重细节配饰，如高品质皮具、袖扣、胸针等，彰显个人品味。定期对衣橱进行专业整理和保养。",
                food: "全面膳食管理，严控食材源头。全面关注家庭所有成员的个性化健康饮食需求，可定期聘请营养师制定详细的家庭膳食计划。订阅高端有机食材宅配服务，确保食材的新鲜、安全与可追溯性，特别关注进口食品的品质认证。注重家庭饮用水的质量，可安装全屋净水系统或选择高端瓶装/桶装饮用水。若有特殊饮食需求（如素食、低敏、健身增肌等），可选择专业的健康餐定制机构长期供餐，或聘请擅长健康烹饪的兼职厨师。",
                housing: "购置改善型大宅，提升社区品质。积极考虑购买或升级置换到更大居住面积（如150平米以上）、拥有更优越景观资源和社区环境的高品质住房。目标可锁定在城市核心区域的高端公寓大平层，或近郊的联排/独栋别墅。选择社区时，高度关注其物业管理水平、安保措施、绿化率、会所设施（如泳池、健身房、儿童游乐区）以及邻里圈层。若进行装修，则聘请知名室内设计师，选用环保、耐用且富有设计感的高端建材和智能家居系统。",
                transport: "配置多功能座驾，尊享商务出行。根据家庭成员的多元化出行需求，可以拥有并合理使用2-3辆不同类型的汽车，例如一辆适合商务出行的豪华轿车（如奥迪A6L、宝马5系、奔驰E级），一辆适合家庭周末出游和长途旅行的七座MPV或大型SUV，甚至可以考虑一辆满足个人驾驶乐趣的跑车或性能车。日常商务出行或机场接送，可固定使用高端专车服务或聘请兼职司机。长途旅行时，优先选择飞机公务舱或以上，以及高铁商务座。",
                learning: "投入精英教育，追求专业顶峰。将相当一部分预算投入到子女的精英教育中，例如选择国内顶尖的国际学校或双语学校，并为其规划海外名校（如美国常春藤、英国G5院校）的升学路径，包括长期的语言培训、标化考试辅导、课外活动及竞赛参与、升学咨询等。个人层面，可以追求更高层次的学术或专业成就，如攻读海外知名大学的在职博士学位、参加行业内极具影响力leader培养项目、或在专业领域进行前沿探索并争取获得国际认可的成果。",
                entertainment: "享受私享娱乐，参与慈善赞助。追求更具私密性和专属性的娱乐休闲方式。例如，可以考虑租赁游艇出海、组织小型私人派对或高端品酒会（邀请专业侍酒师）。积极参与并赞助本地的文化艺术活动，如成为剧院、美术馆的赞助人，支持青年艺术家发展，或对特定的文化遗产保护项目进行捐助。可以开始培养一些具有收藏价值的爱好，如小众艺术品、古董钟表、限量版模型等，既是娱乐也是一种潜在投资。",
                savings: "寻求私人银行，规划税务传承。应急备用金和基础保险配置完成后，财富管理的核心目标是实现资产的持续稳健增值和长期保值。可以主动接触并选择一家或多家信誉良好、专业能力强的私人银行或独立财富管理机构，建立长期合作关系，获取包括投资组合管理、资产配置建议、法律咨询在内的综合性服务。开始系统学习并规划家庭税务筹划（尤其涉及海外资产或收入时），并着手进行初步的资产传承规划，如设立简单的生前信托或配置大额终身寿险。"
            }
        },
        {
            level: 12, minIncome: 26000,
            percentages: { clothing: 6, food: 16, housing: 20, transport: 10, learning: 17, entertainment: 12, savings: 19 },
            advice: {
                clothing: "高级定制加身，彰显尊贵品味。衣着消费进入高级定制（Haute Couture或顶级Bespoke）领域，定期与国内外知名的服装设计师或顶级裁缝坊合作，为重要社交场合、商务活动及日常生活量身打造独一无二的服装。衣橱中拥有针对不同季节、不同场合的完整高品质着装系列和与之匹配的顶级配饰（如限量款腕表、高级珠宝、爱马仕等品牌的稀有皮具）。部分服装本身即为艺术品或具有收藏价值，注重其文化内涵和工艺传承。",
                food: "专职团队服务，极致膳食体验。聘请经验丰富、技艺精湛的全职或兼职家庭厨师，负责每日膳食的采购、搭配与烹饪，确保菜品的多样性、营养均衡和顶级口感。同时，长期聘用专业的注册营养师，与厨师紧密配合，根据家庭成员的年龄、健康状况、口味偏好及特定需求（如健身、孕期、疾病康复期）动态调整膳食方案。在全球范围内搜寻并采购最顶级、最稀有或具有独特产地认证的珍稀食材，打造极致的家庭餐饮体验。",
                housing: "全球优质房产，兼顾多重需求。在国内核心城市黄金地段持有多套高品质住宅的基础上，开始在全球范围内（如纽约、伦敦、巴黎、东京、新加坡等国际大都市，或瑞士、地中海、加勒比等著名度假胜地）战略性配置优质房产。这些房产不仅用于家庭成员的自住、度假或子女海外就学居住，也作为全球资产配置和财富传承的重要组成部分。聘请专业的国际房地产顾问和物业管理公司，负责海外房产的筛选、交易、维护和租赁管理。",
                transport: "尊享座驾与服务，出行高效私密。拥有并使用世界顶级豪华汽车品牌的旗舰车型（如劳斯莱斯、宾利、法拉利、兰博基尼等），并根据不同需求（如商务接待、家庭出游、个人驾驶乐趣）配备多辆不同类型的豪车。聘用形象气质佳、驾驶技术hawk、具备安全意识和保密素养的全职专业司机团队。国内外出差或旅行，首选乘坐头等舱或包机服务，若有需要，可考虑购买或租赁私人飞机/游艇，以确保出行的高度私密性、灵活性与极致舒适度。",
                learning: "培养领袖人才，支持公益教育。为子女提供全球最顶级的精英教育资源，包括但不限于入读世界最著名的私立K-12学校（如伊顿公学、菲利普斯埃克塞特学院等）和常春藤/牛津剑桥等顶级大学的本硕博连读项目。设立家族教育基金，支持子女在学术、艺术、体育等各方面的全面发展。个人层面，除了自身持续学习和提升外，更侧重于运用自身影响力和资源，担任知名大学的客座教授、行业领军企业的导师，或发起并资助具有社会影响力的公益教育项目。",
                entertainment: "深度艺术收藏，拓展高端社交。将艺术品收藏作为一项严肃的爱好和长期的价值投资，在专业艺术顾问的指导下，系统收藏国内外知名艺术家的代表作品或具有高成长潜力的青年艺术家作品。积极参与全球顶级的高端社交圈活动，如国际电影节的私人派对、顶级奢侈品牌的VIP鉴赏会、著名慈善晚宴、马术世界杯、古董车拉力赛等。进行环球旅行或极地、深海等主题探险，追求独特的人生体验和精神满足，并将这些经历融入个人生活方式。",
                savings: "家族财富管理，善用信托工具。财富管理的核心目标转为基业长青的财富保全、风险的极致分散以及跨代际的有序传承。积极运用家族信托、离岸信托等复杂的法律和金融工具，进行财富的隔离保护、税务优化和定向传承安排。与顶尖私人银行家、律师、会计师、信托专家组成的专业团队紧密合作，制定并执行全面的家族财富规划。投资组合将继续国际化和多元化，纳入私募股权、风险投资、对冲基金、房地产投资基金（REITs）等另类资产。"
            }
        },
        // ... existing code ...
        {
            level: 12, minIncome: 26000,
            percentages: { clothing: 6, food: 16, housing: 20, transport: 10, learning: 17, entertainment: 12, savings: 19 },
            advice: {
                clothing: "高级定制加身，彰显尊贵品味。衣着消费进入高级定制（Haute Couture或顶级Bespoke）领域，定期与国内外知名的服装设计师或顶级裁缝坊合作，为重要社交场合、商务活动及日常生活量身打造独一无二的服装。衣橱中拥有针对不同季节、不同场合的完整高品质着装系列和与之匹配的顶级配饰（如限量款腕表、高级珠宝、爱马仕等品牌的稀有皮具）。部分服装本身即为艺术品或具有收藏价值，注重其文化内涵和工艺传承。",
                food: "专职团队服务，极致膳食体验。聘请经验丰富、技艺精湛的全职或兼职家庭厨师，负责每日膳食的采购、搭配与烹饪，确保菜品的多样性、营养均衡和顶级口感。同时，长期聘用专业的注册营养师，与厨师紧密配合，根据家庭成员的年龄、健康状况、口味偏好及特定需求（如健身、孕期、疾病康复期）动态调整膳食方案。在全球范围内搜寻并采购最顶级、最稀有或具有独特产地认证的珍稀食材，打造极致的家庭餐饮体验。",
                housing: "全球优质房产，兼顾多重需求。在国内核心城市黄金地段持有多套高品质住宅的基础上，开始在全球范围内（如纽约、伦敦、巴黎、东京、新加坡等国际大都市，或瑞士、地中海、加勒比等著名度假胜地）战略性配置优质房产。这些房产不仅用于家庭成员的自住、度假或子女海外就学居住，也作为全球资产配置和财富传承的重要组成部分。聘请专业的国际房地产顾问和物业管理公司，负责海外房产的筛选、交易、维护和租赁管理。",
                transport: "尊享座驾与服务，出行高效私密。拥有并使用世界顶级豪华汽车品牌的旗舰车型（如劳斯莱斯、宾利、法拉利、兰博基尼等），并根据不同需求（如商务接待、家庭出游、个人驾驶乐趣）配备多辆不同类型的豪车。聘用形象气质佳、驾驶技术过硬、具备安全意识和保密素养的全职专业司机团队。国内外出差或旅行，首选乘坐头等舱或包机服务，若有需要，可考虑购买或租赁私人飞机/游艇，以确保出行的高度私密性、灵活性与极致舒适度。",
                learning: "培养领袖人才，支持公益教育。为子女提供全球最顶级的精英教育资源，包括但不限于入读世界最著名的私立K-12学校（如伊顿公学、菲利普斯埃克塞特学院等）和常春藤/牛津剑桥等顶级大学的本硕博连读项目。设立家族教育基金，支持子女在学术、艺术、体育等各方面的全面发展。个人层面，除了自身持续学习和提升外，更侧重于运用自身影响力和资源，担任知名大学的客座教授、行业领军企业的导师，或发起并资助具有社会影响力的公益教育项目。",
                entertainment: "深度艺术收藏，拓展高端社交。将艺术品收藏作为一项严肃的爱好和长期的价值投资，在专业艺术顾问的指导下，系统收藏国内外知名艺术家的代表作品或具有高成长潜力的青年艺术家作品。积极参与全球顶级的高端社交圈活动，如国际电影节的私人派对、顶级奢侈品牌的VIP鉴赏会、著名慈善晚宴、马术世界杯、古董车拉力赛等。进行环球旅行或极地、深海等主题探险，追求独特的人生体验和精神满足，并将这些经历融入个人生活方式。",
                savings: "家族财富管理，善用信托工具。财富管理的核心目标转为基业长青的财富保全、风险的极致分散以及跨代际的有序传承。积极运用家族信托、离岸信托等复杂的法律和金融工具，进行财富的隔离保护、税务优化和定向传承安排。与顶尖私人银行家、律师、会计师、信托专家组成的专业团队紧密合作，制定并执行全面的家族财富规划。投资组合将进一步国际化和多元化，纳入私募股权、风险投资、对冲基金、房地产投资基金（REITs）等另类资产。"
            }
        },
        {
            level: 13, minIncome: 30000,
            percentages: { clothing: 6, food: 15, housing: 19, transport: 10, learning: 18, entertainment: 12, savings: 20 },
            advice: {
                clothing: "尊享专属造型，购藏顶级孤品。聘请业内知名的个人专属造型师或形象顾问，进行全年乃至更长期的整体形象规划与管理，包括服装、发型、配饰及出席重要场合的整体造型。开始关注并购买全球顶级奢侈品牌（如Hermès, Chanel, Loro Piana等）的高级成衣系列，甚至可以尝试接触并购买设计师品牌的限量款、走秀款或孤品。衣橱管理趋向专业化，可能需要独立的衣帽间及专业的衣物护理服务。",
                food: "极致食材品控，私享顶级厨艺。对食材的品质、产地、稀缺性以及烹饪技艺的追求达到极致。在全球范围内搜寻并采购最顶级的食材，如特定年份的红酒、A5级和牛、阿尔巴白松露、顶级鱼子酱等。长期聘用具有国际视野和米其林餐厅背景的顶级私人厨师，根据家庭成员的健康状况和口味偏好，每日定制并料理三餐及宴会。可以打造专业的家庭厨房和私人酒窖/雪茄房，满足高品质的居家餐饮和社交需求。",
                housing: "全球战略置业，多元资产配置。房产投资进入全球化战略配置阶段。除了在国内一线城市核心地段持有多套高价值物业外，开始在海外主流国际都市（如纽约、伦敦、东京、悉尼）或风景优美的度假胜地（如瑞士阿尔卑斯、法国蔚蓝海岸、马尔代夫）购置具有投资价值或符合家庭生活方式的房产，包括豪华公寓、别墅、庄园等。聘请专业的国际房地产投资顾问团队，负责全球房产的筛选、尽职调查、交易、法律税务及后续管理。",
                transport: "配置豪华车队，尊享出行方案。根据不同生活场景和家庭成员需求，拥有并维护一个由多辆不同功能的豪华汽车组成的车队，例如用于商务出行的劳斯莱斯或宾利，用于家庭旅行的顶级大型SUV或MPV，以及满足个人驾驶乐趣的高性能跑车或敞篷车。对于更长途或跨国出行，开始常态化考虑租赁或分时共享私人飞机、公务机，甚至在条件成熟时考虑购买小型私人飞机或游艇，并聘用专业的机组人员和管理团队。",
                learning: "设立教育基金，促进家族传承。为保障子女乃至孙辈获得最优质的全球教育资源，并支持其在学术、艺术、体育等多方面的个性化发展，可以考虑设立规模可观的、由专业机构管理的家族教育基金或信托。积极参与并资助国际性的高端学术会议、文化交流项目或顶尖科研机构的特定研究。个人层面，除了持续学习深造外，更侧重于将知识、经验和价值观通过著书立说、公开演讲、担任客座教授或社会导师等方式进行传承与分享。",
                entertainment: "投资娱乐产业，践行影响力慈善。娱乐方式从单纯的消费体验，向参与投资和运营感兴趣的娱乐项目或场所转变，例如投资精品酒店、特色餐厅、小型艺术画廊、马术俱乐部或私人博物馆等，将个人爱好与事业相结合。慈善行为更具规划性和影响力，可以考虑成立小型的私人慈善基金会，或与大型慈善机构合作设立专项基金，针对特定领域（如教育、医疗、环保、艺术）进行持续、大额的捐赠，并积极参与相关的公益活动和决策。",
                savings: "启用家族办公室，全球分散风险。财富体量达到一定规模后，为实现更专业、更私密、更全面的财富管理和传承，可以考虑设立单一家族办公室（SFO）或加入联合家族办公室（MFO）。通过家族办公室，整合顶尖的投资顾问、税务师、律师、信托专家等资源，进行全球化的资产配置、风险管理、税务筹划、法律咨询、慈善规划、家族治理以及跨代传承等一系列复杂事务。投资组合将涵盖所有主流及另类资产类别，实现高度的风险分散和个性化定制。"
            }
        },
        {
            level: 14, minIncome: 35000,
            percentages: { clothing: 6, food: 14, housing: 19, transport: 10, learning: 19, entertainment: 11, savings: 21 },
            advice: {
                clothing: "联袂顶尖设计，塑造个性品牌。与国际顶尖的时装设计师、高级珠宝设计师或知名造型艺术大师建立长期合作关系，共同为个人量身打造完全个性化、具有高度辨识度的整体形象与衣橱体系。所穿着的服饰、佩戴的珠宝及使用的配饰，不仅仅是奢侈品，更是个人独特品味、社会地位乃至人生哲学的艺术化表达。可能会受邀参加巴黎、米兰等国际时装周的顶级品牌大秀前排，或成为某些品牌的特邀贵宾及灵感缪斯。",
                food: "探寻全球珍馐，定制专属味蕾。饮食体验上升到对全球范围内最珍稀食材、最独特烹饪技艺以及最私密专属餐饮场景的极致探索。例如，安排私人团队前往特定产区（如意大利皮埃蒙特采松露、日本筑地市场拍金枪鱼）搜寻当季顶级食材。聘请拥有世界级声誉的米其林三星大厨或特定菜系宗师级人物，为家庭提供阶段性的专属餐饮顾问服务，或为其量身定制独一无二的家宴菜单及烹饪指导。对饮品（如名庄葡萄酒、单一麦芽威士忌、顶级香槟）有深度研究和收藏。",
                housing: "管理高价值组合，传承家族地产。持有并积极管理一个由多个位于全球核心城市顶级地段或拥有独特稀缺资源（如私人岛屿、历史城堡、大型庄园）的高价值房产组成的投资组合。这些房产不仅是重要的资产增值工具和现金流来源，也可能承载着家族历史、文化传承或特殊生活方式的意义。聘用专业的资产管理公司和法律团队，负责房产的日常运营、维护、租赁、税务合规以及潜在的收购与处置，确保其长期价值最大化。",
                transport: "典藏高性能座驾，私享高效出行。个人车库中可能拥有一系列高性能跑车、限量版超级跑车、经典古董车或特别定制的豪华座驾，这些车辆不仅是代步工具，更是个人爱好、品味与收藏实力的体现。积极参与国际性的高端汽车俱乐部活动、经典车拉力赛或赛道体验日。在出行方面，私人飞机（无论是自有、分时租赁或顶级包机服务）已成为中长途旅行或商务出行的常态化选择，以最大限度保证时间效率、行程灵活性和绝对私密性。",
                learning: "赋能家族发展，成就专业巅峰。为家族成员（尤其是下一代）提供全方位、高度定制化的教育支持和个人发展平台，可能包括设立家族奖学金、支持创业孵化、提供实习与导师资源、培养领导力与社会责任感。个人在自身专业领域内已取得公认的卓越成就，拥有广泛的国际影响力，可能担任国际行业组织的领导职务、受邀在世界顶尖学府发表演讲或担任荣誉教授、作为重要智库成员参与国家乃至全球性政策的咨询与制定。",
                entertainment: "赞助顶级盛事，深耕高雅爱好。作为重要的赞助人或合作伙伴，深度参与并支持国际顶级的文化、艺术、体育或慈善盛事，例如成为主要艺术双年展的首席赞助商、支持一支参与国际大赛的体育队伍、或冠名某项重要的科学奖项。个人兴趣爱好发展到专业级别，可能拥有私人艺术收藏馆、参与专业马术比赛、驾驶帆船进行环球航行，或在某一冷门但极具文化价值的领域（如古籍善本收藏、古典乐器演奏）达到鉴赏家或表演者水平。",
                savings: "驾驭复杂投资，铸造百年基业。财富管理已进入战略层面，进行高度复杂和定制化的全球资产配置。通过家族办公室或顶级私人银行，直接参与或配置于私募股权投资基金（PE）、风险投资基金（VC）、杠杆收购基金（LBO）、对冲基金、房地产直接投资项目、大宗商品以及其他结构化产品。投资决策更注重长期价值创造、风险的动态管理以及与家族理念和社会责任的一致性。财富传承规划已非常完善，通过信托、基金会等多种工具确保家族财富的平稳过渡和百年基业的持续发展。"
            }
        },
        // ... existing code ...
        {
            level: 14, minIncome: 35000,
            percentages: { clothing: 6, food: 14, housing: 19, transport: 10, learning: 19, entertainment: 11, savings: 21 },
            advice: {
                clothing: "联袂顶尖设计，塑造个性品牌。与国际顶尖的时装设计师、高级珠宝设计师或知名造型艺术大师建立长期合作关系，共同为个人量身打造完全个性化、具有高度辨识度的整体形象与衣橱体系。所穿着的服饰、佩戴的珠宝及使用的配饰，不仅仅是奢侈品，更是个人独特品味、社会地位乃至人生哲学的艺术化表达。可能会受邀参加巴黎、米兰等国际时装周的顶级品牌大秀前排，或成为某些品牌的特邀贵宾及灵感缪斯。",
                food: "探寻全球珍馐，定制专属味蕾。饮食体验上升到对全球范围内最珍稀食材、最独特烹饪技艺以及最私密专属餐饮场景的极致探索。例如，安排私人团队前往特定产区（如意大利皮埃蒙特采松露、日本筑地市场拍金枪鱼）搜寻当季顶级食材。聘请拥有世界级声誉的米其林三星大厨或特定菜系宗师级人物，为家庭提供阶段性的专属餐饮顾问服务，或为其量身定制独一无二的家宴菜单及烹饪指导。对饮品（如名庄葡萄酒、单一麦芽威士忌、顶级香槟）有深度研究和收藏。",
                housing: "管理高价值组合，传承家族地产。持有并积极管理一个由多个位于全球核心城市顶级地段或拥有独特稀缺资源（如私人岛屿、历史城堡、大型庄园）的高价值房产组成的投资组合。这些房产不仅是重要的资产增值工具和现金流来源，也可能承载着家族历史、文化传承或特殊生活方式的意义。聘用专业的资产管理公司和法律团队，负责房产的日常运营、维护、租赁、税务合规以及潜在的收购与处置，确保其长期价值最大化。",
                transport: "典藏高性能座驾，私享高效出行。个人车库中可能拥有一系列高性能跑车、限量版超级跑车、经典古董车或特别定制的豪华座驾，这些车辆不仅是代步工具，更是个人爱好、品味与收藏实力的体现。积极参与国际性的高端汽车俱乐部活动、经典车拉力赛或赛道体验日。在出行方面，私人飞机（无论是自有、分时租赁或顶级包机服务）已成为中长途旅行或商务出行的常态化选择，以最大限度保证时间效率、行程灵活性和绝对私密性。",
                learning: "赋能家族发展，成就专业巅峰。为家族成员（尤其是下一代）提供全方位、高度定制化的教育支持和个人发展平台，可能包括设立家族奖学金、支持创业孵化、提供实习与导师资源、培养领导力与社会责任感。个人在自身专业领域内已取得公认的卓越成就，拥有广泛的国际影响力，可能担任国际行业组织的领导职务、受邀在世界顶尖学府发表演讲或担任荣誉教授、作为重要智库成员参与国家乃至全球性政策的咨询与制定。",
                entertainment: "赞助顶级盛事，深耕高雅爱好。作为重要的赞助人或合作伙伴，深度参与并支持国际顶级的文化、艺术、体育或慈善盛事，例如成为主要艺术双年展的首席赞助商、支持一支参与国际大赛的体育队伍、或冠名某项重要的科学奖项。个人兴趣爱好发展到专业级别，可能拥有私人艺术收藏馆、参与专业马术比赛、驾驶帆船进行环球航行，或在某一冷门但极具文化价值的领域（如古籍善本收藏、古典乐器演奏）达到鉴赏家或表演者水平。",
                savings: "驾驭复杂投资，铸造百年基业。财富管理已进入战略层面，进行高度复杂和定制化的全球资产配置。通过家族办公室或顶级私人银行，直接参与或配置于私募股权投资基金（PE）、风险投资基金（VC）、杠杆收购基金（LBO）、对冲基金、房地产直接投资项目、大宗商品以及其他结构化产品。投资决策更注重长期价值创造、风险的动态管理以及与家族理念和社会责任的一致性。财富传承规划已非常完善，通过信托、基金会等多种工具确保家族财富的平稳过渡和百年基业的持续发展。"
            }
        },
        {
            level: 15, minIncome: 40000,
            percentages: { clothing: 6, food: 13, housing: 18, transport: 10, learning: 20, entertainment: 10, savings: 23 },
            advice: {
                clothing: "精心塑造个人品牌，着装彰显影响力。衣着选择已成为个人品牌形象建设与维护不可或缺的一环。与顶级形象顾问、私人造型师保持长期合作，共同打造符合个人身份、职业需求及社会角色的高辨识度着装体系。衣橱中以高级定制（Bespoke/Haute Couture）、一线奢侈品牌经典款及具有独特设计理念的设计师作品为主。积极参与并受邀出席国内外重要的时尚活动、品牌发布会或私人鉴赏会，着装选择往往能引领或反映一定的潮流趋势。",
                food: "尊享全球顶级佳肴，掌控专属供应链。频繁享受全球范围内的顶级美食体验，成为知名米其林三星餐厅或同等级别高端食府的常客。可能与特定顶级餐厅的主厨建立私人联系，享受定制菜单或优先预订服务。开始构建专属的、可全球追溯的顶级食材供应链，例如直接从特定产区订购稀有年份的葡萄酒、特级初榨橄榄油、陈年火腿、野生菌菇等。对于日常家庭餐饮，亦有极高品质要求，可能聘用米其林背景厨师提供阶段性服务或咨询。",
                housing: "战略管理地产组合，关注长期增值。将房地产视为核心资产配置类别之一，积极在全球范围内进行战略性布局与管理。投资组合中不仅包括位于国际大都市核心地段的顶级豪宅、服务式公寓，也可能涉及具有独特稀缺性或历史文化价值的物业（如古堡、庄园），以及具有稳定现金流的优质商业地产项目（如写字楼、商铺）。高度关注房产的地段、建筑品质、设计理念、物业服务以及中长期的资本增值潜力与风险控制。",
                transport: "出行高效私密，私航初体验。出行方式的选择充分体现个人品味、时间效率与高度私密性的需求。除了拥有并使用顶级品牌的豪华轿车、SUV及跑车外，开始频繁使用私人飞机或公务机包机服务进行国内及周边国际的长途旅行与商务出行。在条件成熟时，可能会考虑购买中小型私人飞机的部分所有权（分时共享），或成为某公务机运营公司的会员，享受更灵活、更专属的航空出行解决方案。配备专业的司机团队。",
                learning: "战略投入教育传承，设立专项基金。在子女教育上，确保其获得全球最顶尖的教育资源，并为其提供广阔的国际视野和发展平台。个人及家族层面，开始在教育和知识传承方面进行战略性投入，例如向母校或国内外知名大学进行大额捐赠，设立以家族名义命名的奖学金、讲席教授或研究基金，支持特定学科领域的发展或优秀人才的培养。个人持续进行高层次的认知提升和智慧沉淀，可能参与顶级智库的研讨或私董会。",
                entertainment: "追求独特文化体验，投资艺术项目。娱乐方式更侧重于追求独特且富有深度文化内涵的体验。积极参与并赞助高水平的艺术展览、音乐节、戏剧演出或电影项目，甚至可能作为天使投资人或出品人直接参与到某些具有潜力的文化艺术项目中。开始系统性地收藏具有较高艺术价值和升值潜力的当代艺术品、古董、稀有乐器或手稿。进行一般人难以企及的深度文化探索旅行，如参与考古发掘体验、随学者进行古文明遗址考察等。",
                savings: "聚焦财富保全增值，善用金融法律。财富管理的核心目标是确保现有财富的安全、实现长期稳健的增值，并为家族财富的有序传承做好周全规划。与顶尖私人银行家、家族办公室顾问、税务师及律师团队紧密合作，运用包括但不限于大额保单、家族信托、遗嘱规划、慈善基金会等多种金融及法律工具，进行全面的财富保护与代际传承安排。投资组合高度全球化、多元化，并根据宏观经济形势和家族目标进行动态优化和风险管理。"
            }
        },
        {
            level: 16, minIncome: 50000,
            percentages: { clothing: 5, food: 12, housing: 18, transport: 10, learning: 20, entertainment: 10, savings: 25 },
            advice: {
                clothing: "着装即身份象征，专属定制常态化。服装不仅是满足日常穿着和社交需求，更已成为个人身份、社会地位、生活态度与独特品味的鲜明象征。衣橱几乎完全由国内外顶级设计师的高级定制（Haute Couture/Bespoke）服装构成，每一件都体现着极致的工艺、稀有的面料和专属的设计理念。与数位国际顶级设计师或裁缝大师保持着长期而密切的合作关系。拥有并佩戴博物馆收藏级别的臻品珠宝与腕表。着装选择常与慈善理念、艺术品位或家族传承相关联。",
                food: "极致膳食艺术，引领健康生活。对饮食的要求达到艺术与科学的完美结合，引领高品质、超健康的生活方式。可能聘用由米其林星级厨师、资深营养学家、专业品酒师/茶艺师组成的私人膳食顾问团队。在全球范围内拥有稳定、顶级的专属食材供应渠道，确保每日都能享用到最新鲜、最稀有、最符合个人健康需求的定制膳食。家庭厨房按照专业餐厅后厨标准设计和配备。可能拥有或参与投资高端有机农场、特色酒庄或精品食材品牌。",
                housing: "持有全球标志物业，彰显家族底蕴。在全球一线国际大都市（如纽约、伦敦、巴黎、香港、上海）的顶级地段，或在世界闻名的独特度假区（如私人岛屿、瑞士雪山、法国酒庄产区）拥有并管理多处标志性、具有传承价值的顶级房产。这些物业不仅仅是居所或投资品，更是家族历史、财富实力与生活品味的象征，部分物业可能因其独特的建筑设计、历史背景或曾居住名人而闻名。配备专业的管家团队和物业维护系统，确保房产始终处于最佳状态。",
                transport: "出行方案高度定制，私密舒适至上。出行工具的选择与使用完全围绕个性化需求、极致舒适度、最高效率和绝对私密性展开。可能拥有并运营一架或多架中远程私人公务机或直升机，并聘有专属的飞行及机务保障团队。车库中停放着一系列根据不同需求定制的顶级豪华汽车、防弹座驾或珍稀古董车，并有专业司机团队随时待命。对于海上出行，可能拥有或长期租赁大型豪华游艇，用于家庭度假或高端社交。",
                learning: "创办教育机构，推动知识创新。在教育领域的投入从支持转向引领和创造。可能亲自创办或深度参与管理具有创新教育理念的K-12学校、特色学院或专业研究机构，致力于培养具有国际视野和社会责任感的未来领袖。设立大规模的家族教育基金会，在全球范围内资助前沿科学研究、人文艺术创新项目，或设立具有国际影响力的学术奖项，推动人类知识的进步与传播。个人可能在世界顶尖学府拥有荣誉教职或担任重要学术顾问。",
                entertainment: "深度参与文体公益，实现社会价值。娱乐休闲活动与具有深远社会影响力的文化、体育及公益事业深度融合。可能成为国际重要博物馆、交响乐团、歌剧院或体育赛事的主要赞助人或理事会成员，积极参与其战略发展和运营决策。通过个人影响力发起或组织大型慈善拍卖、公益音乐会、体育名人邀请赛等活动，为特定社会问题筹集资金并提升公众认知。将个人爱好（如艺术品收藏、马术、帆船）与慈善事业相结合，赋予其更广泛的社会价值。",
                savings: "构建完善家族体系，实现基业长青。建立并运营一个功能完善、架构清晰的单一家族办公室（Single Family Office），全面负责家族财富的集中管理、投资运作、风险控制、税务筹划、法律事务、慈善事业、家族治理、成员教育以及跨代传承等所有核心事务。家族财富管理体系高度制度化、专业化，确保在复杂多变的全球环境中实现基业长青和家族精神的延续。投资策略极度成熟，涵盖全球所有资产类别，并积极寻求具有长期战略意义的直接投资机会（如科技创新、医疗健康、可持续发展等领域）。"
            }
        },
        // ... existing code ...
        {
            level: 16, minIncome: 50000,
            percentages: { clothing: 5, food: 12, housing: 18, transport: 10, learning: 20, entertainment: 10, savings: 25 },
            advice: {
                clothing: "着装即身份象征，专属定制常态化。服装不仅是满足日常穿着和社交需求，更已成为个人身份、社会地位、生活态度与独特品味的鲜明象征。衣橱几乎完全由国内外顶级设计师的高级定制（Haute Couture/Bespoke）服装构成，每一件都体现着极致的工艺、稀有的面料和专属的设计理念。与数位国际顶级设计师或裁缝大师保持着长期而密切的合作关系。拥有并佩戴博物馆收藏级别的臻品珠宝与腕表。着装选择常与慈善理念、艺术品位或家族传承相关联。",
                food: "极致膳食艺术，引领健康生活。对饮食的要求达到艺术与科学的完美结合，引领高品质、超健康的生活方式。可能聘用由米其林星级厨师、资深营养学家、专业品酒师/茶艺师组成的私人膳食顾问团队。在全球范围内拥有稳定、顶级的专属食材供应渠道，确保每日都能享用到最新鲜、最稀有、最符合个人健康需求的定制膳食。家庭厨房按照专业餐厅后厨标准设计和配备。可能拥有或参与投资高端有机农场、特色酒庄或精品食材品牌。",
                housing: "持有全球标志物业，彰显家族底蕴。在全球一线国际大都市（如纽约、伦敦、巴黎、香港、上海）的顶级地段，或在世界闻名的独特度假区（如私人岛屿、瑞士雪山、法国酒庄产区）拥有并管理多处标志性、具有传承价值的顶级房产。这些物业不仅仅是居所或投资品，更是家族历史、财富实力与生活品味的象征，部分物业可能因其独特的建筑设计、历史背景或曾居住名人而闻名。配备专业的管家团队和物业维护系统，确保房产始终处于最佳状态。",
                transport: "出行方案高度定制，私密舒适至上。出行工具的选择与使用完全围绕个性化需求、极致舒适度、最高效率和绝对私密性展开。可能拥有并运营一架或多架中远程私人公务机或直升机，并聘有专属的飞行及机务保障团队。车库中停放着一系列根据不同需求定制的顶级豪华汽车、防弹座驾或珍稀古董车，并有专业司机团队随时待命。对于海上出行，可能拥有或长期租赁大型豪华游艇，用于家庭度假或高端社交。",
                learning: "创办教育机构，推动知识创新。在教育领域的投入从支持转向引领和创造。可能亲自创办或深度参与管理具有创新教育理念的K-12学校、特色学院或专业研究机构，致力于培养具有国际视野和社会责任感的未来领袖。设立大规模的家族教育基金会，在全球范围内资助前沿科学研究、人文艺术创新项目，或设立具有国际影响力的学术奖项，推动人类知识的进步与传播。个人可能在世界顶尖学府拥有荣誉教职或担任重要学术顾问。",
                entertainment: "深度参与文体公益，实现社会价值。娱乐休闲活动与具有深远社会影响力的文化、体育及公益事业深度融合。可能成为国际重要博物馆、交响乐团、歌剧院或体育赛事的主要赞助人或理事会成员，积极参与其战略发展和运营决策。通过个人影响力发起或组织大型慈善拍卖、公益音乐会、体育名人邀请赛等活动，为特定社会问题筹集资金并提升公众认知。将个人爱好（如艺术品收藏、马术、帆船）与慈善事业相结合，赋予其更广泛的社会价值。",
                savings: "构建完善家族体系，实现基业长青。建立并运营一个功能完善、架构清晰的单一家族办公室（Single Family Office），全面负责家族财富的集中管理、投资运作、风险控制、税务筹划、法律事务、慈善事业、家族治理、成员教育以及跨代传承等所有核心事务。家族财富管理体系高度制度化、专业化，确保在复杂多变的全球环境中实现基业长青和家族精神的延续。投资策略极度成熟，涵盖全球所有资产类别，并积极寻求具有长期战略意义的直接投资机会（如科技创新、医疗健康、可持续发展等领域）。"
            }
        },
        {
            level: 17, minIncome: 60000,
            percentages: { clothing: 5, food: 11, housing: 17, transport: 9, learning: 21, entertainment: 9, savings: 28 },
            advice: {
                clothing: "构筑审美顶峰，引领风尚潮流。衣橱本身即为个人审美品味与生活哲学的极致体现，可能包含少量但极具代表性的、由世界顶级服装设计大师或传奇工匠为其量身打造的传世之作。与数位国际知名设计师保持着超越商业合作的长期友谊与互动，可能参与其设计灵感讨论或成为其非公开作品的首位体验者。部分服饰具有博物馆收藏级别，其选择往往能在特定圈层内引领风尚，或成为媒体关注的焦点。更注重服装背后的文化、艺术及工艺价值。",
                food: "尊享顶级膳食管理，融合全球风味。长期聘用由米其林三星级厨师、资深注册营养师、国际认证品酒师/茶艺师等组成的顶级私人膳食管理团队，为家庭提供全方位、全天候的健康饮食规划与执行。团队不仅负责日常三餐的极致料理，更能根据家庭宴请、社交活动、海外旅行等不同场景需求，呈现融合全球风味与顶级烹饪艺术的盛宴。在全球范围内拥有稳定且私密的顶级珍稀食材（如特定产区限量和牛、深海野生鱼子酱、百年老藤葡萄酒）的专属供应渠道。",
                housing: "全球物业组合，专业团队维护。在全球范围内，于最具价值的国际都会（如纽约、伦敦、巴黎、日内瓦、香港）和顶级度假胜地（如加勒比私人岛屿、法国阿尔卑斯滑雪庄园、意大利托斯卡纳酒庄）拥有并精心管理一个由多处地标性或极具设计感的豪宅、古堡、庄园组成的物业组合。每一处物业都聘请顶尖建筑师、室内设计师进行个性化打造和定期焕新，并由专业的物业管理公司或专属管家团队进行全年无休的维护与运营。",
                transport: "私享顶级出行，高效舒适兼备。拥有并常态化运营一架或多架最新型号的中远程私人公务机（如湾流G650ER、庞巴迪环球7500）及直升机，配备经验丰富的全职飞行员、乘务员和地勤维护团队。车库中不仅有劳斯莱斯、宾利等顶级豪华轿车，还有限量版超级跑车、经典古董车以及满足特殊地形（如越野、雪地）需求的专业车辆。出行前由专业团队进行周密路线规划、安保评估及目的地礼宾服务安排，确保全球旅行的高效、私密与极致舒适。",
                learning: "深度文化投入，资助前沿探索。在知识获取和文化修养方面进行战略性、大规模的深度投入。可能以个人或家族名义，向世界顶尖大学（如哈佛、牛津、剑桥）或重要科研机构（如诺贝尔奖实验室）捐赠巨资，设立永久性的讲席教授、研究中心或专项基金，支持在生命科学、人工智能、宇宙探索等前沿领域的突破性研究。积极参与并资助全球性的文化遗产保护项目，如修复古城遗址、抢救濒危语言文化、数字化古代典籍等。",
                entertainment: "娱乐即艺术生活，追求极致精神体验。娱乐活动已升华为一种生活艺术和精神追求。可能委托国际著名当代艺术家为其创作大型专属艺术品，或邀请世界级音乐家、表演团体进行私人演奏会或演出。深度参与并赞助国际顶级的艺术节（如萨尔茨堡音乐节、威尼斯双年展）、电影节（如戛纳、奥斯卡）、体育赛事（如奥运会、世界杯的VIP包厢）。进行极具个性化和挑战性的环球探险旅行，如私人定制的极地科考、深海潜水探索、太空旅行体验等。",
                savings: "驾驭复杂金融，铸就百年家族。财富管理已进入高度复杂的全球化运作阶段，通常通过设立功能完备的单一家族办公室（Single Family Office），聘用包括顶尖投资总监（CIO）、法律顾问、税务专家、慈善顾问在内的专业团队，对庞大的家族财富进行系统化管理。投资组合涵盖全球所有公开市场和私募市场，包括直接股权投资、风险投资、对冲基金、房地产基金、基础设施项目等。运用复杂的国际信托、基金会等法律架构，进行财富的长期保值、风险隔离、税务优化和跨越多代的慈善及家族精神传承。"
            }
        },
        {
            level: 18, minIncome: 70000,
            percentages: { clothing: 5, food: 10, housing: 16, transport: 9, learning: 22, entertainment: 8, savings: 30 },
            advice: {
                clothing: "着装承载哲学，引领社会风尚。服装选择已完全超越物质层面，成为个人独特生活哲学、社会责任感和深远影响力的外在表达。可能与全球顶级时装设计学院合作，设立奖学金或青年设计师扶持计划，推动时尚产业的创新与可持续发展。衣橱中不仅有顶级定制，更可能包含具有重大历史意义或承载特殊文化符号的服饰，每一件都有其故事和内涵。个人着装风格可能被视为时代偶像，深刻影响公众审美和社会风尚。",
                food: "饮食承载社交文化，倡导健康风尚。饮食活动不仅是为了满足个人及家庭的顶级健康与味蕾需求，更成为承载高端社交、文化交流、商业洽谈乃至慈善活动的重要载体。可能在家中设立达到专业标准的宴会厅及品酒室，定期举办汇聚各界领袖与精英的私享宴会或主题沙龙。积极倡导并投资于全球范围内的可持续农业、食品科技创新（如细胞培养肉、植物基食品）以及健康饮食文化的推广项目，通过自身影响力推动行业进步。",
                housing: "传承历史名邸，塑造家族象征。持有并精心修复、管理多处在全球范围内具有重大历史价值、独特建筑风格或曾为名人故居的顶级房产（如欧洲古堡、美洲庄园、亚洲园林府邸），并将其作为家族文化与精神传承的核心载体。这些物业不仅仅是居住空间，更是举办重要家族会议、接待国际贵宾、进行文化艺术交流的场所，其本身即为家族历史和影响力的活化石。对物业的维护和运营引入博物馆级别的专业标准和科技手段。",
                transport: "掌控全球出行，兼顾安全与责任。拥有并运营一支由最新型、最高安全标准、最环保科技（如可持续航空燃料SAF的应用）的私人飞机、直升机及豪华游艇组成的出行舰队。出行决策完全服务于个人及家族的全球日程、绝对安全和高度私密需求，并能灵活应对各种突发状况。配备顶级的专业机组、船员、安保团队及全球地面支持网络。在追求极致出行体验的同时，也开始关注并投入于绿色航空、智能交通等前瞻性技术领域。",
                learning: "赋能全球教育，塑造未来领袖。致力于在全球范围内推动教育的公平性、创新性与质量提升，对人类社会发展做出战略性、系统性的重大贡献。可能发起并全额资助创办具有全球影响力的新型大学、研究院或国际学校，其教育理念和培养模式旨在塑造能够应对未来全球挑战的领袖人才。设立永久性的、大规模的全球奖学金计划，惠及各国优秀青年。深度参与国际教育政策的制定与改革，推动全球教育资源的共享与合作。",
                entertainment: "融合文娱慈善，彰显社会担当。娱乐活动已完全与个人事业版图、社会责任履行和战略性慈善事业紧密结合，成为彰显家族价值观和提升社会影响力的重要平台。例如，通过家族基金会发起并主导具有全球性影响的大型文化艺术项目、体育公益赛事或环保主题探险活动，旨在唤起公众对特定社会议题的关注并募集善款。个人可能担任国际重要文化机构（如联合国教科文组织、世界自然基金会）的亲善大使或高级顾问。",
                savings: "构筑永续基业，贡献人类福祉。财富管理的最高目标是实现家族基业的永续发展、核心价值观的代际传承，并通过战略性慈善和影响力投资，为解决全球性的重大挑战（如气候变化、公共卫生、贫困问题、文化冲突等）贡献力量，增进人类福祉。家族办公室的运作已超越单纯的财富管理，成为一个集投资、慈善、家族治理、社会创新于一体的综合性平台。财富传承规划不仅考虑家族成员，更着眼于如何将家族资源更有效地回馈社会，留下具有深远积极影响的精神与物质遗产。"
            }
        },
        // ... existing code ...
        {
            level: 18, minIncome: 70000,
            percentages: { clothing: 5, food: 10, housing: 16, transport: 9, learning: 22, entertainment: 8, savings: 30 },
            advice: {
                clothing: "着装承载哲学，引领社会风尚。服装选择已完全超越物质层面，成为个人独特生活哲学、社会责任感和深远影响力的外在表达。可能与全球顶级时装设计学院合作，设立奖学金或青年设计师扶持计划，推动时尚产业的创新与可持续发展。衣橱中不仅有顶级定制，更可能包含具有重大历史意义或承载特殊文化符号的服饰，每一件都有其故事和内涵。个人着装风格可能被视为时代偶像，深刻影响公众审美和社会风尚。",
                food: "饮食承载社交文化，倡导健康风尚。饮食活动不仅是为了满足个人及家庭的顶级健康与味蕾需求，更成为承载高端社交、文化交流、商业洽谈乃至慈善活动的重要载体。可能在家中设立达到专业标准的宴会厅及品酒室，定期举办汇聚各界领袖与精英的私享宴会或主题沙龙。积极倡导并投资于全球范围内的可持续农业、食品科技创新（如细胞培养肉、植物基食品）以及健康饮食文化的推广项目，通过自身影响力推动行业进步。",
                housing: "传承历史名邸，塑造家族象征。持有并精心修复、管理多处在全球范围内具有重大历史价值、独特建筑风格或曾为名人故居的顶级房产（如欧洲古堡、美洲庄园、亚洲园林府邸），并将其作为家族文化与精神传承的核心载体。这些物业不仅仅是居住空间，更是举办重要家族会议、接待国际贵宾、进行文化艺术交流的场所，其本身即为家族历史和影响力的活化石。对物业的维护和运营引入博物馆级别的专业标准和科技手段。",
                transport: "掌控全球出行，兼顾安全与责任。拥有并运营一支由最新型、最高安全标准、最环保科技（如可持续航空燃料SAF的应用）的私人飞机、直升机及豪华游艇组成的出行舰队。出行决策完全服务于个人及家族的全球日程、绝对安全和高度私密需求，并能灵活应对各种突发状况。配备顶级的专业机组、船员、安保团队及全球地面支持网络。在追求极致出行体验的同时，也开始关注并投入于绿色航空、智能交通等前瞻性技术领域。",
                learning: "赋能全球教育，塑造未来领袖。致力于在全球范围内推动教育的公平性、创新性与质量提升，对人类社会发展做出战略性、系统性的重大贡献。可能发起并全额资助创办具有全球影响力的新型大学、研究院或国际学校，其教育理念和培养模式旨在塑造能够应对未来全球挑战的领袖人才。设立永久性的、大规模的全球奖学金计划，惠及各国优秀青年。深度参与国际教育政策的制定与改革，推动全球教育资源的共享与合作。",
                entertainment: "融合文娱慈善，彰显社会担当。娱乐活动已完全与个人事业版图、社会责任履行和战略性慈善事业紧密结合，成为彰显家族价值观和提升社会影响力的重要平台。例如，通过家族基金会发起并主导具有全球性影响的大型文化艺术项目、体育公益赛事或环保主题探险活动，旨在唤起公众对特定社会议题的关注并募集善款。个人可能担任国际重要文化机构（如联合国教科文组织、世界自然基金会）的亲善大使或高级顾问。",
                savings: "构筑永续基业，贡献人类福祉。财富管理的最高目标是实现家族基业的永续发展、核心价值观的代际传承，并通过战略性慈善和影响力投资，为解决全球性的重大挑战（如气候变化、公共卫生、贫困问题、文化冲突等）贡献力量，增进人类福祉。家族办公室的运作已超越单纯的财富管理，成为一个集投资、慈善、家族治理、社会创新于一体的综合性平台。财富传承规划不仅考虑家族成员，更着眼于如何将家族资源更有效地回馈社会，留下具有深远积极影响的精神与物质遗产。"
            }
        },
        {
            level: 19, minIncome: 85000,
            percentages: { clothing: 4, food: 9, housing: 15, transport: 8, learning: 23, entertainment: 7, savings: 34 },
            advice: {
                clothing: "着装即宣言，高级品牌表达。衣着选择已成为个人独特品牌形象、社会角色及核心价值观的高级视觉表达。衣橱几乎完全由全球顶级时装屋的高级定制（Haute Couture）、顶级设计师的限量作品以及拥有深厚历史底蕴的奢侈品牌的经典之作构成。可能与特定设计师或品牌建立深度合作，参与设计理念的探讨，或成为其保护和传承传统手工艺项目的支持者。着装不仅追求极致美学与工艺，更承载着对文化、艺术及社会责任的理解与担当。",
                food: "臻享全球珍馐，引领健康风尚。饮食是生活品质与健康理念的极致彰显。在全球范围内拥有稳定且顶级的私人食材供应网络，确保能随时享用到最稀有、最符合伦理标准（如有机、可持续、人道养殖）的顶级食材。私人厨师团队由具有国际米其林三星餐厅背景的主厨领衔，并配备专业营养师、品酒师，为家庭成员及贵宾定制融合全球烹饪艺术与前沿健康科学的专属膳食方案。可能投资或支持符合个人理念的有机农场、特色酒庄或创新食品科技企业。",
                housing: "典藏传世府邸，承载家族荣光。在全球范围内拥有并精心管理一系列具有重大文化意义、独特建筑价值或特殊历史背景的顶级物业，如历史悠久的城堡、大型田园庄园、由普利兹克奖得主设计的现代艺术豪宅等。这些府邸不仅是家族主要的居住、社交和度假场所，更是家族历史、文化品味与社会影响力的重要象征与传承载体。配备专业的物业管理、安保及管家团队，确保府邸的完美维护与高效运营。",
                transport: "全球高效出行，私密安全至上。出行方式的选择完全服务于个人及家族的全球日程安排、绝对安全保障和最高私密性需求。可能拥有并运营一支由最新型远程公务机、大型直升机以及超级豪华游艇组成的私人交通工具舰队，并聘用经验丰富的国际化机组、船员及安保团队。在全球主要城市均设有或可随时调用顶级的地面交通及礼宾接待服务。所有出行计划均由专业的私人旅行办公室或秘书团队进行周密安排与协调。",
                learning: "资助全球教育科研，铸就精神丰碑。在全球范围内，对教育、科学研究及文化艺术创新领域进行战略性、大规模的 philanthropic（慈善）投入，留下宝贵的、可传承的精神财富。可能以家族名义，向世界顶尖大学或科研机构捐赠巨资，设立永久性的冠名学院、研究院、实验室或全球学者计划。积极资助并深度参与能够推动人类认知边界、解决全球性重大挑战或保护濒危文化遗产的前沿项目。个人通过著述、演讲或参与国际智库，贡献思想与智慧。",
                entertainment: "策动高端社交，赋能社会进步。通过精心策划和举办具有国际影响力的高端社交活动、文化论坛或慈善晚宴，汇聚全球政商学界领袖、文化艺术名流及社会创新者，共同探讨并推动解决重要的社会、经济或环境议题。个人的娱乐和社交活动已完全融入其慈善事业和发挥社会影响力的整体战略之中。可能拥有或深度参与运营具有重要文化地标意义的艺术机构、体育俱乐部或高端会员制社群，并以此为平台促进跨界合作与社会进步。",
                savings: "家族基金会运作，实现社会价值。设立并有效运营一个具有清晰使命、专业治理结构和全球视野的家族基金会。基金会不仅管理着庞大的慈善资产，更通过战略性的项目资助、影响力投资（Impact Investing）和积极的政策倡导，在教育、医疗、环保、扶贫、文化等多个领域系统性地解决社会问题，创造可持续的正面社会价值。财富管理的核心目标已超越单纯的资产增值，更侧重于如何将家族财富有效地转化为推动社会进步和人类福祉的持久动力。"
            }
        },
        {
            level: 20, minIncome: 100000, // 使用100000作为基准，实际可能更高
            percentages: { clothing: 4, food: 8, housing: 14, transport: 8, learning: 24, entertainment: 6, savings: 36 }, // 百分比为示例，可根据实际调整
            advice: {
                clothing: "着装即艺术与责任，风格定义时代。个人着装风格已臻化境，成为全球时尚界和文化领域公认的时代偶像与灵感源泉。衣橱不仅是顶级定制与传世孤品的集合，更是一座流动的艺术馆，每一件服饰都承载着深厚的文化内涵、精湛的工艺美学与鲜明的个人哲学。可能与世界顶级博物馆合作，将其部分珍藏服饰作为重要展品。积极倡导并引领可持续时尚、道德时尚的发展，利用自身影响力推动时尚产业的社会责任与创新。",
                food: "饮食哲学引领者，健康生活布道者。饮食理念与实践已达到哲学与艺术的高度，不仅为个人及家族带来极致的健康与味蕾享受，更通过著述、演讲、投资或创办相关机构，在全球范围内积极倡导并引领一种可持续、有意识、高品质的健康生活方式。可能资助全球性的食品安全研究、营养科学创新或濒危食材保护项目。家庭膳食管理团队堪称世界顶级，其烹饪理念与技艺对高端餐饮界亦有启发和引领作用。",
                housing: "世界级地标物业，家族恒久象征。拥有并传承一系列在全球范围内独一无二、具有无可替代的历史地位、文化价值或建筑艺术成就的世界级标志性地产组合（如私人岛屿、国家级历史保护建筑、可传世的当代建筑杰作）。这些物业不仅仅是财富的象征，更是家族精神、文化遗产和全球影响力的永恒见证。其管理和维护标准堪比世界级文化机构，并可能部分对公众或特定研究领域开放，承担一定的社会文化功能。",
                transport: "全球出行自由，方案极致定制。拥有并按需调度包括超远程洲际公务机、大型豪华游艇、直升机编队以及全地形特种车辆在内的全套、顶级、高度定制化的全球出行解决方案。专业的国际化出行管理与安保团队（可能包括退役特种兵）确保在全球任何角落的行程都能实现最高效率、绝对安全和极致私密。出行工具本身即为科技与奢华的顶峰之作，并可能被用于人道主义援助、科学考察等特殊任务，彰显社会责任。",
                learning: "铸就人类知识殿堂，启迪万世思想。对全球教育、科学探索、文化传承及艺术创新的贡献达到不朽的、改变人类历史进程的级别。可能发起并永久资助旨在解决人类最根本问题的跨学科、跨国界、跨世纪的宏大研究计划（如攻克癌症、实现清洁能源、探索宇宙起源）。创办或重塑世界级的高等学府、科研机构、博物馆、图书馆，使其成为人类智慧与文明的灯塔，启迪并惠及万世。个人思想与著述被视为时代经典，深刻影响全球学术界与公众认知。",
                entertainment: "娱乐即创造传世价值，定义生活高度。娱乐活动已完全升华为一种创造和分享传世文化价值、彰显最高人生境界的生活哲学。可能亲自构思、投资并主导制作具有里程碑意义的史诗级电影、歌剧、大型艺术装置或沉浸式文化体验项目，其影响力将持续数十年乃至上百年。通过家族基金会或个人名义，在全球范围内发起并运营旨在保护世界文化多样性、促进跨文明对话、提升人类精神福祉的大型、永久性文化公益项目。",
                savings: "家族财富为基石，致力全球福祉。构建并领导一个具有全球影响力、跨越数代的家族事业与慈善传承体系。家族办公室不仅管理着规模庞大的全球资产，更将其视为推动人类社会可持续发展和应对全球性挑战的战略资源。通过影响力投资、战略慈善、政策倡导以及与其他全球领袖和组织的合作，致力于在教育、医疗、环境、和平等核心领域取得突破性进展，为全人类创造更美好的未来，留下可永续传承的、具有深远历史意义的正面遗产。"
            }
        }
    ];

    // --- Helper Functions ---
// ... existing code ..

    // --- Helper Functions ---
// ... existing code ...


    // --- Helper Functions ---
// ... existing code ...


    // --- Helper Functions ---

    // --- Helper Functions ---
    function saveData() {
        localStorage.setItem('monthlyIncome', monthlyIncome);
        localStorage.setItem('budgetSettings', JSON.stringify(budgetSettings));
        localStorage.setItem('expenses', JSON.stringify(expenses));
        console.log("Data saved:", { monthlyIncome, budgetSettings, expenses });
    }

    function loadData() {
        const storedIncome = localStorage.getItem('monthlyIncome');
        const storedBudgetSettings = localStorage.getItem('budgetSettings');
        const storedExpenses = localStorage.getItem('expenses');

        if (storedIncome) monthlyIncome = parseFloat(storedIncome);
        if (storedBudgetSettings) budgetSettings = JSON.parse(storedBudgetSettings);
        if (storedExpenses) expenses = JSON.parse(storedExpenses);
        
        calculateActualBudgets(); // 加载数据后计算实际预算
        console.log("Data loaded:", { monthlyIncome, budgetSettings, expenses });
    }

    // --- 核心逻辑 ---
    function calculateActualBudgets() {
        actualBudgets = {}; // 重置
        for (const category in budgetSettings) {
            if (budgetSettings.hasOwnProperty(category) && monthlyIncome > 0) {
                actualBudgets[category] = (monthlyIncome * (budgetSettings[category] / 100)).toFixed(2);
            } else {
                actualBudgets[category] = 0;
            }
        }
    }
    
    function updateBudgetPercentageDisplay() {
        // if (!totalPercentageSpan) return; // Old
        if (!totalPercentageValueSpan || !totalPercentageBar) return; // 只在首页执行

        let total = 0;
        budgetPercentageSliders.forEach(slider => {
            const category = slider.dataset.category;
            const percentage = parseFloat(slider.value) || 0;
            budgetSettings[category] = percentage; // 更新 budgetSettings
            total += percentage;

            // 更新滑块旁边的百分比显示
            const percentageDisplaySpan = document.getElementById(`percentage-display-${category}`);
            if (percentageDisplaySpan) {
                percentageDisplaySpan.textContent = percentage;
            }

            // 更新单个类别的实际预算显示
            const actualBudgetSpan = document.getElementById(`actual-budget-${category}`);
            if (actualBudgetSpan && monthlyIncome > 0) {
                actualBudgetSpan.textContent = `(￥${(monthlyIncome * (percentage / 100)).toFixed(2)})`;
            } else if (actualBudgetSpan) {
                actualBudgetSpan.textContent = `(￥0.00)`;
            }
        });

        totalPercentageValueSpan.textContent = total;
        totalPercentageBar.style.width = `${Math.min(total, 100)}%`; // Cap at 100% for display

        if (total !== 100) {
            totalPercentageValueSpan.style.color = 'red';
            totalPercentageBar.classList.add('invalid');
            totalPercentageBar.classList.remove('valid'); // Assuming you might add a 'valid' class
        } else {
            totalPercentageValueSpan.style.color = 'green';
            totalPercentageBar.classList.remove('invalid');
            totalPercentageBar.classList.add('valid'); // Or just rely on default green
            totalPercentageBar.style.backgroundColor = '#28a745'; // Ensure green
        }
        if (total > 100) { // If total exceeds 100, also mark as invalid
             totalPercentageBar.style.backgroundColor = '#dc3545'; // Red
        }


        calculateActualBudgets(); // 实时计算实际预算
    }

    function handleSaveSetup() {
        const incomeValue = parseFloat(monthlyIncomeInput.value);
        if (isNaN(incomeValue) || incomeValue <= 0) {
            alert("请输入有效的月收入！");
            return;
        }
        monthlyIncome = incomeValue;

        let totalPercentage = 0;
        // Recalculate total from budgetSettings as sliders might have been the source of truth
        for (const category in budgetSettings) {
            if (budgetSettings.hasOwnProperty(category)) {
                totalPercentage += budgetSettings[category];
            }
        }
        // budgetPercentageSliders.forEach(slider => { // Or from sliders directly
        //     totalPercentage += parseFloat(slider.value) || 0;
        // });


        if (Math.round(totalPercentage) !== 100) { // Use Math.round for potential float issues
            alert("预算总分配比例必须为 100%！当前为 " + totalPercentage.toFixed(2) + "%");
            return;
        }
        
        updateBudgetPercentageDisplay(); // 确保 budgetSettings 是最新的
        saveData();
        alert("设置已保存！");
        renderBudgetOverview(); // 更新首页概览
        renderIncomeLevelSuggestions(); // 新增：渲染收入建议
    }
    
    function handleQuickSetup() {
        // 示例快速设置
        const exampleSettings = { food: 30, clothing: 10, housing: 20, transport: 10, learning: 10, entertainment: 10, savings: 10 };
        budgetPercentageSliders.forEach(slider => {
            const category = slider.dataset.category;
            const exampleValue = exampleSettings[category] || 0;
            slider.value = exampleValue;
            // Manually trigger update for display spans
            const percentageDisplaySpan = document.getElementById(`percentage-display-${category}`);
            if (percentageDisplaySpan) {
                percentageDisplaySpan.textContent = exampleValue;
            }
        });
        if (monthlyIncomeInput) monthlyIncomeInput.value = monthlyIncomeInput.value || 5000; // 示例收入
        monthlyIncome = parseFloat(monthlyIncomeInput.value) || 5000;
        updateBudgetPercentageDisplay();
        // 不直接保存，让用户确认后点击保存
        alert("已填入快速设置示例，请确认月收入后点击“保存设置”。");
    }

    function handleAddExpense() {
        if (!expenseDateInput || !expenseCategorySelect || !expenseAmountInput) return; // 只在记录页执行

        const date = expenseDateInput.value;
        const category = expenseCategorySelect.value;
        const amount = parseFloat(expenseAmountInput.value);
        const description = expenseDescriptionInput.value.trim();

        if (!date) {
            alert("请选择日期！");
            return;
        }
        if (isNaN(amount) || amount <= 0) {
            alert("请输入有效的消费金额！");
            return;
        }
        if (!category) {
            alert("请选择消费类别！");
            return;
        }
        if (Object.keys(actualBudgets).length === 0 || !actualBudgets[category]) {
            alert("请先在首页设置预算！");
            return;
        }

        expenses.push({ date, category, amount, description });
        saveData();
        alert("消费记录已添加！");
        
        // 清空表单
        expenseAmountInput.value = '';
        expenseDescriptionInput.value = '';
        // expenseDateInput.value = ''; // 可选，或设为当天
        
        renderBudgetStatus(); // 更新预算状态显示
    }

    // --- UI 渲染函数 ---
    function renderBudgetOverview() {
        if (!budgetOverviewContainer) return; // 只在首页执行
        if (Object.keys(actualBudgets).length === 0 || monthlyIncome === 0) {
            budgetOverviewContainer.innerHTML = "<p>请先完成初始设置并保存。</p>";
            return;
        }

        let html = `<h3>月收入: ￥${monthlyIncome.toFixed(2)}</h3>`;
        for (const category in actualBudgets) {
            if (actualBudgets.hasOwnProperty(category)) {
                const budgetAmount = parseFloat(actualBudgets[category]);
                const spent = getCategorySpent(category);
                const remaining = budgetAmount - spent;
                const progress = budgetAmount > 0 ? (spent / budgetAmount) * 100 : 0;

                html += `
                    <div class="category-overview">
                        <h4>${CATEGORIES[category]} (预算: ￥${budgetAmount.toFixed(2)})</h4>
                        <p>已消费: ￥${spent.toFixed(2)}</p>
                        <p>剩余: ￥${remaining.toFixed(2)}</p>
                        <div class="progress-bar-container">
                            <div class="progress-bar ${getProgressBarClass(progress, remaining, budgetAmount)}" style="width: ${Math.min(progress, 100)}%;">
                                ${Math.min(progress, 100).toFixed(0)}%
                            </div>
                        </div>
                    </div>
                `;
            }
        }
        budgetOverviewContainer.innerHTML = html;
    }

    function renderBudgetStatus() { // 用于记录消费页面
        if (!budgetStatusContainer) return; // 只在记录页执行
        if (Object.keys(actualBudgets).length === 0) {
            budgetStatusContainer.innerHTML = "<p>请先在首页设置预算。</p>";
            return;
        }

        let html = "";
        for (const category in actualBudgets) {
            // 通常储蓄不在这里显示为可消费项，除非有特殊逻辑
            if (actualBudgets.hasOwnProperty(category) && category !== 'savings') { 
                const budgetAmount = parseFloat(actualBudgets[category]);
                const spent = getCategorySpent(category);
                const remaining = budgetAmount - spent;
                const progress = budgetAmount > 0 ? (spent / budgetAmount) * 100 : 0;

                html += `
                    <div class="category-status">
                        <h4>${CATEGORIES[category]} (预算: ￥${budgetAmount.toFixed(2)})</h4>
                        <p>剩余: ￥${remaining.toFixed(2)}</p>
                        <div class="progress-bar-container">
                            <div class="progress-bar ${getProgressBarClass(progress, remaining, budgetAmount)}" style="width: ${Math.min(progress, 100)}%;">
                                ${Math.min(progress, 100).toFixed(0)}%
                            </div>
                        </div>
                        ${remaining < 0 ? '<p style="color:red;">已超支!</p>' : ''}
                        ${progress > 80 && progress <= 90 && remaining > 0 ? '<p style="color:orange;">预算接近临界!</p>' : ''}
                        ${progress > 90 && remaining > 0 ? '<p style="color:red;">预算即将用尽!</p>' : ''}
                    </div>
                `;
            }
        }
        budgetStatusContainer.innerHTML = html;
    }
    
    function getCategorySpent(category, monthYear = null) { // monthYear e.g., "2024-07"
        let totalSpent = 0;
        const currentMonthYear = monthYear || new Date().toISOString().slice(0, 7);

        expenses.forEach(expense => {
            if (expense.category === category && expense.date.startsWith(currentMonthYear)) {
                totalSpent += expense.amount;
            }
        });
        return totalSpent;
    }

    function getProgressBarClass(progress, remaining, budgetAmount) {
        if (budgetAmount <= 0) return ''; // 没有预算则无状态
        if (remaining < 0) return 'danger'; // 超支
        if (progress > 90) return 'danger'; // 红色：超过90%
        if (progress > 80) return 'warning'; // 黄色：超过80%
        return ''; // 绿色 (默认)
    }

    function renderSummaryPage() {
        if (!summaryTotalIncomeSpan) return; // 只在总结页执行

        const currentMonthYear = new Date().toISOString().slice(0, 7); // 例如 "2024-07"
        
        summaryTotalIncomeSpan.textContent = monthlyIncome.toFixed(2);

        let totalMonthExpense = 0;
        const categoryExpenses = {};
        for (const cat in CATEGORIES) { categoryExpenses[cat] = 0; }

        expenses.forEach(expense => {
            if (expense.date.startsWith(currentMonthYear)) {
                totalMonthExpense += expense.amount;
                if (categoryExpenses.hasOwnProperty(expense.category)) {
                    categoryExpenses[expense.category] += expense.amount;
                }
            }
        });

        summaryTotalExpenseSpan.textContent = totalMonthExpense.toFixed(2);
        const remainingBalance = monthlyIncome - totalMonthExpense;
        summaryTotalRemainingSpan.textContent = remainingBalance.toFixed(2);
        if (remainingBalance < 0) {
            summaryTotalRemainingSpan.classList.add('negative');
        } else {
            summaryTotalRemainingSpan.classList.remove('negative');
        }


        let categorySummaryHtml = "";
        const chartLabels = [];
        const chartData = [];
        const chartColors = []; // For pie chart

        const predefinedColors = ['#FF6384', '#36A2EB', '#FFCE56', '#4BC0C0', '#9966FF', '#FF9F40', '#C9CBCF'];


        let colorIndex = 0;
        for (const category in categoryExpenses) {
            if (CATEGORIES.hasOwnProperty(category)) {
                const spent = categoryExpenses[category];
                const percentage = totalMonthExpense > 0 ? (spent / totalMonthExpense * 100).toFixed(1) : 0;
                categorySummaryHtml += `
                    <div>
                        <strong>${CATEGORIES[category]}:</strong> ￥${spent.toFixed(2)} (${percentage}%)
                    </div>`;
                if (spent > 0) { // 只将有消费的类别加入图表
                    chartLabels.push(CATEGORIES[category]);
                    chartData.push(spent);
                    chartColors.push(predefinedColors[colorIndex % predefinedColors.length]);
                    colorIndex++;
                }
            }
        }
        categorySummaryContainer.innerHTML = categorySummaryHtml;

        // 渲染图表 (需要 Chart.js 或其他库)
        if (expenseChartCanvas && typeof Chart !== 'undefined') {
            // 销毁旧图表实例（如果存在）
            if (window.myExpenseChart instanceof Chart) {
                window.myExpenseChart.destroy();
            }
            const ctx = expenseChartCanvas.getContext('2d');
            window.myExpenseChart = new Chart(ctx, {
                type: 'pie', // 或 'bar'
                data: {
                    labels: chartLabels,
                    datasets: [{
                        label: '本月消费分布',
                        data: chartData,
                        backgroundColor: chartColors,
                        hoverOffset: 4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false, // 可以调整图表大小
                    plugins: {
                        legend: {
                            position: 'top',
                        },
                        title: {
                            display: true,
                            text: '本月消费分布图'
                        }
                    }
                }
            });
        } else if (expenseChartCanvas) {
            expenseChartCanvas.parentElement.innerHTML = "<p>图表库 (例如 Chart.js) 未加载，无法显示图表。</p>";
        }
        
        // 消费建议 (简单示例)
        let suggestions = "消费情况良好。";
        if (totalMonthExpense > monthlyIncome) {
            suggestions = "注意！本月总支出已超出总收入，请检查各项开支。";
        } else {
            let highSpendingCategories = [];
            for (const category in categoryExpenses) {
                if (actualBudgets[category] && categoryExpenses[category] > parseFloat(actualBudgets[category])) {
                    highSpendingCategories.push(CATEGORIES[category]);
                }
            }
            if (highSpendingCategories.length > 0) {
                suggestions = `以下类别超出预算：${highSpendingCategories.join('、')}。建议下月调整预算或控制消费。`;
            }
        }
        suggestionText.textContent = suggestions;
    }


    // --- 新增：收入建议相关函数 ---
    function findMatchingIncomeLevelIndex(currentIncome) {
        if (currentIncome <= 0) return -1; // 无效收入

        let matchedIndex = -1;
        // 从最高级别开始匹配，找到第一个低于或等于用户收入的级别
        for (let i = incomeLevelsData.length - 1; i >= 0; i--) {
            if (currentIncome >= incomeLevelsData[i].minIncome) {
                matchedIndex = i;
                break;
            }
        }
        // 如果收入低于所有定义的最低级别，则匹配最低级别
        if (matchedIndex === -1 && incomeLevelsData.length > 0) {
            // matchedIndex = 0; // 或者返回-1表示无精确匹配，让调用者决定如何处理
            return -1; // 表示没有找到合适的级别，或者收入过低
        }
        return matchedIndex;
    }

    function getIncomeSuggestions() {
        const matchedIndex = findMatchingIncomeLevelIndex(monthlyIncome);
        if (matchedIndex === -1) {
            return []; // 没有匹配到或收入过低
        }

        const suggestionsToShow = [];
        // 添加匹配到的级别
        suggestionsToShow.push(incomeLevelsData[matchedIndex]);

        // 添加最多三个更低的级别
        for (let i = 1; i <= 3; i++) {
            const lowerIndex = matchedIndex - i;
            if (lowerIndex >= 0) {
                suggestionsToShow.push(incomeLevelsData[lowerIndex]);
            } else {
                break; // 没有更低的级别了
            }
        }
        return suggestionsToShow;
    }

    function renderIncomeLevelSuggestions() {
        if (!incomeSuggestionsContainer) return; // 只在首页执行

        if (monthlyIncome <= 0) {
            incomeSuggestionsContainer.innerHTML = "<p>请输入并保存您的月收入以查看建议。</p>";
            return;
        }

        const suggestions = getIncomeSuggestions();

        if (suggestions.length === 0) {
            incomeSuggestionsContainer.innerHTML = "<p>根据您当前的收入，暂无匹配的消费建议。或您的收入低于建议系统的最低标准。</p>";
            return;
        }

        let html = "";
        suggestions.forEach((levelData, index) => {
            let titlePrefix = "";
            if (index === 0) {
                titlePrefix = "当前匹配级别";
            } else {
                titlePrefix = `低 ${index} 级参考`;
            }

            html += `<div class="income-suggestion-level">`;
            html += `<h4>${titlePrefix} (级别 ${levelData.level} - 月收入参考: ￥${levelData.minIncome}+)</h4>`;
            html += `<div class="suggestion-details">`;

            for (const categoryKey in CATEGORIES) {
                if (levelData.percentages.hasOwnProperty(categoryKey) && levelData.advice.hasOwnProperty(categoryKey)) {
                    html += `<div class="suggestion-category-item">
                                <strong>${CATEGORIES[categoryKey]} (建议占比: ${levelData.percentages[categoryKey]}%)</strong>
                                <p>${levelData.advice[categoryKey]}</p>
                             </div>`;
                }
            }
            html += `</div></div>`; // close suggestion-details and income-suggestion-level
        });
        incomeSuggestionsContainer.innerHTML = html;
    }


    // --- 初始化和事件监听 ---
    function init() {
        loadData(); // 加载已有数据

        // 根据当前页面路径执行特定初始化
        const path = window.location.pathname.split("/").pop();

        if (path === 'index.html' || path === '') { // 首页
            if (monthlyIncomeInput) monthlyIncomeInput.value = monthlyIncome > 0 ? monthlyIncome : '';
            
            budgetPercentageSliders.forEach(slider => {
                const category = slider.dataset.category;
                if (budgetSettings[category] !== undefined) {
                    slider.value = budgetSettings[category];
                    // Update display span as well
                    const percentageDisplaySpan = document.getElementById(`percentage-display-${category}`);
                    if (percentageDisplaySpan) {
                        percentageDisplaySpan.textContent = budgetSettings[category];
                    }
                } else { // Ensure sliders for new categories (if any) default to 0
                    slider.value = 0;
                    const percentageDisplaySpan = document.getElementById(`percentage-display-${category}`);
                    if (percentageDisplaySpan) {
                        percentageDisplaySpan.textContent = 0;
                    }
                }
            });

            updateBudgetPercentageDisplay(); // 更新百分比和实际预算显示
            renderBudgetOverview(); // 渲染预算概览
            renderIncomeLevelSuggestions(); // 新增：页面加载时也尝试渲染建议

            if (saveSetupButton) saveSetupButton.addEventListener('click', handleSaveSetup);
            if (quickSetupButton) quickSetupButton.addEventListener('click', handleQuickSetup);
            if (monthlyIncomeInput) monthlyIncomeInput.addEventListener('input', updateBudgetPercentageDisplay);
            
            budgetPercentageSliders.forEach(slider => {
                slider.addEventListener('input', updateBudgetPercentageDisplay); // 'input' event for live updates
            });
        } else if (path === 'record.html') { // 记录页
            if (expenseDateInput) expenseDateInput.valueAsDate = new Date(); // 默认当天
            renderBudgetStatus();
            if (addExpenseButton) addExpenseButton.addEventListener('click', handleAddExpense);
        } else if (path === 'summary.html') { // 总结页
            renderSummaryPage();
        }
    }

    init(); // 页面加载时执行初始化
});